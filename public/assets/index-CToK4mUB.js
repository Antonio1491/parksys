import{a4 as n,u as X,ar as J,R as he,j as e,bh as je,f as r,i as c,cn as Y,bk as ms,bl as os,bm as pe,bi as ge,bn as Ne,U as xs,O as ue,al as F,bO as z,a6 as hs,V as W,W as fe,Y as ve,_ as be,$ as ye,a0 as w,B as l,X as js,a7 as we,a8 as Ce,D as ps,g as Se,h as Ee,ad as gs,aP as De,bV as ke,an as Pe,n as Me,p as Ae,v as x,aX as Re,aY as Te,y as Ns,I as us,J as fs,K as vs,N as bs,q as C,M as ys,bT as Fe,bW as ze,bX as Ie,bY as Le,bZ as Oe,b_ as $e,b$ as Ve,c0 as qe,cV as S,cU as Z,a3 as g}from"./index-BKCBrrzQ.js";const Cs=()=>{var me,oe,xe;const[E,Be]=n.useState(""),[D,Ue]=n.useState("all"),[k,_e]=n.useState("all"),[h,P]=n.useState(1),[I,ee]=n.useState("cards"),[t,Ge]=n.useState(null),[He,L]=n.useState(!1),[se,Ke]=n.useState("registrations"),[O,ae]=n.useState("cards"),[M,B]=n.useState(1),[d,A]=n.useState([]),[Qe,U]=n.useState(!1),[te,ie]=n.useState(null),[Xe,_]=n.useState(!1),[R,le]=n.useState(""),[T,ne]=n.useState(""),G=10,Je=10,{data:v,isLoading:Ye}=X({queryKey:["/api/activity-registrations",h,E,D,k,R,T],queryFn:async()=>{const s=new URLSearchParams({page:h.toString(),limit:Je.toString(),...E&&{search:E},...D!=="all"&&{status:D},...k!=="all"&&{activity:k},...R&&{startDate:R},...T&&{endDate:T}}),a=await fetch(`/api/activity-registrations?${s}`);if(!a.ok)throw new Error("Error al cargar inscripciones");return a.json()}}),{data:We}=X({queryKey:["/api/activities"],queryFn:async()=>{const s=await fetch("/api/activities");if(!s.ok)throw new Error("Error al cargar actividades");return s.json()}}),{data:j,isLoading:Ze}=X({queryKey:["/api/activities-summary-data"],queryFn:async()=>{const s=await fetch("/api/activities-summary-data");if(!s.ok)throw new Error("Error al cargar resumen de actividades");return s.json()},enabled:se==="summary"}),N=(v==null?void 0:v.registrations)||[],u=((me=v==null?void 0:v.pagination)==null?void 0:me.totalPages)||1,es=We||[],$=(j==null?void 0:j.length)||0,b=Math.ceil($/G),H=(M-1)*G,re=H+G,ce=(j==null?void 0:j.slice(H,re))||[],f=J({mutationFn:async({id:s,status:a,reason:i})=>{const o=await fetch(`/api/activity-registrations/${s}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,rejectionReason:i})});if(!o.ok)throw new Error("Error al actualizar estado");return o.json()},onSuccess:()=>{S({title:"Estado actualizado",description:"El estado de la inscripción ha sido actualizado exitosamente."}),Z.invalidateQueries({queryKey:["/api/activity-registrations"]})},onError:()=>{S({title:"Error",description:"Hubo un problema al actualizar el estado de la inscripción.",variant:"destructive"})}}),K=J({mutationFn:async s=>{const a=await fetch(`/api/activity-registrations/${s}`,{method:"DELETE"});if(!a.ok){const i=await a.json();throw new Error(i.error||"Error al eliminar inscripción")}return a.json()},onSuccess:s=>{S({title:"Inscripción eliminada",description:s.message}),Z.invalidateQueries({queryKey:["/api/activity-registrations"]}),ie(null),U(!1)},onError:s=>{S({title:"Error",description:s.message,variant:"destructive"})}}),V=J({mutationFn:async s=>{const a=await fetch("/api/activity-registrations/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrationIds:s})});if(!a.ok){const i=await a.json();throw new Error(i.error||"Error al eliminar inscripciones")}return a.json()},onSuccess:s=>{S({title:"Inscripciones eliminadas",description:s.message}),Z.invalidateQueries({queryKey:["/api/activity-registrations"]}),A([]),_(!1)},onError:s=>{S({title:"Error",description:s.message,variant:"destructive"})}}),Q=s=>{switch(s){case"approved":return e.jsxs(C,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),"Aprobada"]});case"rejected":return e.jsxs(C,{variant:"destructive",children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),"Rechazada"]});case"pending":default:return e.jsxs(C,{variant:"secondary",children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),"Pendiente"]})}};he.useEffect(()=>{P(1)},[R,T,D,k,E]);const m=N,y=(s,a,i)=>{f.mutate({id:s,status:a,reason:i})},ss=()=>{const s=[["Actividad","Participante","Email","Teléfono","Estado","Fecha de Inscripción"],...m.map(p=>{var q;return[((q=p.activity)==null?void 0:q.title)||"",p.participantName,p.participantEmail,p.participantPhone||"",p.status,x(new Date(p.registrationDate),"dd/MM/yyyy",{locale:g})]})].map(p=>p.map(q=>`"${q}"`).join(",")).join(`
`),a="\uFEFF",i=new Blob([a+s],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=URL.createObjectURL(i),o.download=`inscripciones_actividades_${x(new Date,"dd-MM-yyyy")}.csv`,o.click()},de=s=>{Ge(s),L(!0)},as=(s,a)=>{A(a?i=>[...i,s]:i=>i.filter(o=>o!==s))},ts=s=>{A(s?m.map(a=>a.id):[])},is=m.length>0&&d.length===m.length,ls=d.length>0&&d.length<m.length,ns=s=>{ie(s),U(!0)},rs=()=>{te&&K.mutate(te)},cs=()=>{_(!0)},ds=()=>{V.mutate(d)};return Ye?e.jsx(je,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando inscripciones..."})]})})}):e.jsx(je,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(r,{className:"p-4 bg-gray-50",children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Inscripciones"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administra las inscripciones ciudadanas a actividades públicas"})]})}),e.jsxs(ms,{value:se,onValueChange:Ke,className:"w-full",children:[e.jsxs(os,{className:"grid w-full grid-cols-2",children:[e.jsxs(pe,{value:"registrations",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Inscripciones"]}),e.jsxs(pe,{value:"summary",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Resumen de Actividades"]})]}),e.jsxs(Ne,{value:"registrations",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Inscripciones"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.length})]}),e.jsx(xs,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:N.filter(s=>s.status==="pending").length})]}),e.jsx(ue,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aprobadas"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.filter(s=>s.status==="approved").length})]}),e.jsx(F,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rechazadas"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:N.filter(s=>s.status==="rejected").length})]}),e.jsx(z,{className:"h-8 w-8 text-red-600"})]})})})]}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(hs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(W,{placeholder:"Buscar por nombre, email o actividad...",value:E,onChange:s=>Be(s.target.value),className:"pl-10"})]}),e.jsxs(fe,{value:D,onValueChange:Ue,children:[e.jsx(ve,{className:"w-40",children:e.jsx(be,{placeholder:"Estado"})}),e.jsxs(ye,{children:[e.jsx(w,{value:"all",children:"Todos los estados"}),e.jsx(w,{value:"pending",children:"Pendientes"}),e.jsx(w,{value:"approved",children:"Aprobadas"}),e.jsx(w,{value:"rejected",children:"Rechazadas"})]})]}),e.jsxs(fe,{value:k,onValueChange:_e,children:[e.jsx(ve,{className:"w-48",children:e.jsx(be,{placeholder:"Actividad"})}),e.jsxs(ye,{children:[e.jsx(w,{value:"all",children:"Todas las actividades"}),es.map(s=>e.jsx(w,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Desde"}),e.jsx(W,{type:"date",value:R,onChange:s=>le(s.target.value),className:"w-40"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs text-gray-500 mb-1",children:"Hasta"}),e.jsx(W,{type:"date",value:T,onChange:s=>ne(s.target.value),className:"w-40"})]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{le(""),ne(""),P(1)},className:"flex items-center gap-2",children:[e.jsx(js,{className:"h-4 w-4"}),"Limpiar Fechas"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex border rounded-lg p-1",children:[e.jsxs(l,{variant:I==="cards"?"default":"ghost",size:"sm",onClick:()=>ee("cards"),className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-4 w-4"}),"Grid"]}),e.jsxs(l,{variant:I==="table"?"default":"ghost",size:"sm",onClick:()=>ee("table"),className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Lista"]})]}),e.jsxs(l,{variant:"outline",onClick:ss,className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"}),"Exportar CSV"]})]})]})})}),e.jsxs(r,{children:[e.jsx(Se,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx(Ee,{children:"Inscripciones de Actividades"}),e.jsxs(gs,{children:["Gestiona las solicitudes de inscripción de los ciudadanos (",N.length," total)"]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{id:"select-all",checked:is,ref:s=>{s&&(s.indeterminate=ls)},onCheckedChange:ts}),e.jsx("label",{htmlFor:"select-all",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Seleccionar todo"})]}),d.length>0&&e.jsxs(l,{variant:"destructive",size:"sm",onClick:cs,disabled:V.isPending,className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Eliminar (",d.length,")"]})]})]})}),e.jsx(c,{children:m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay inscripciones"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron inscripciones con los filtros aplicados."})]}):e.jsxs(e.Fragment,{children:[I==="cards"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(s=>{var a;return e.jsx(r,{className:"hover:shadow-md transition-shadow",children:e.jsxs(c,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(De,{checked:d.includes(s.id),onCheckedChange:i=>as(s.id,i)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.participantName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.participantEmail})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>de(s),className:"h-8 w-8 p-0",children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ns(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(ke,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium truncate",children:(a=s.activity)==null?void 0:a.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsx("span",{children:x(new Date(s.registrationDate),"dd/MM/yyyy",{locale:g})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[Q(s.status),s.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{size:"sm",onClick:()=>y(s.id,"approved"),disabled:f.isPending,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:e.jsx(F,{className:"h-3 w-3"})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>{const i=prompt("Motivo del rechazo (opcional):");y(s.id,"rejected",i||void 0)},disabled:f.isPending,className:"h-8 px-2",children:e.jsx(z,{className:"h-3 w-3"})})]})]})]})},s.id)})}),I==="table"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Participante"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actividad"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Email"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Estado"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Fecha"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Acciones"})]})}),e.jsx("tbody",{children:m.map(s=>{var a;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.participantName}),s.participantPhone&&e.jsx("div",{className:"text-sm text-gray-600",children:s.participantPhone})]})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"font-medium",children:(a=s.activity)==null?void 0:a.title})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:s.participantEmail})}),e.jsx("td",{className:"p-3",children:Q(s.status)}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:x(new Date(s.registrationDate),"dd/MM/yyyy",{locale:g})})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>de(s),className:"h-8 w-8 p-0",children:e.jsx(Pe,{className:"h-4 w-4"})}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{size:"sm",onClick:()=>y(s.id,"approved"),disabled:f.isPending,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:e.jsx(F,{className:"h-3 w-3"})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>{const i=prompt("Motivo del rechazo (opcional):");y(s.id,"rejected",i||void 0)},disabled:f.isPending,className:"h-8 px-2",children:e.jsx(z,{className:"h-3 w-3"})})]})]})})]},s.id)})})]})})]})})]}),u>1&&e.jsx(r,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Página ",h," de ",u," • Mostrando ",m.length," de ",N.length," inscripciones"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>P(s=>Math.max(s-1,1)),disabled:h===1,className:"flex items-center gap-1",children:[e.jsx(Re,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,u)},(s,a)=>{let i;return u<=5?i=a+1:i=Math.max(1,h-2)+a,i>u?null:e.jsx(l,{variant:h===i?"default":"outline",size:"sm",onClick:()=>P(i),className:h===i?"bg-[#00a587] hover:bg-[#067f5f]":"",children:i},i)})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>P(s=>Math.min(s+1,u)),disabled:h===u,className:"flex items-center gap-1",children:["Siguiente",e.jsx(Te,{className:"h-4 w-4"})]})]})]})})}),e.jsx(Ns,{open:He,onOpenChange:L,children:e.jsxs(us,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(fs,{children:[e.jsx(vs,{children:"Detalles de la Inscripción"}),e.jsx(bs,{children:"Ver información completa del participante y la actividad"})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información del Participante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre completo"}),e.jsx("p",{className:"text-lg font-semibold",children:t.participantName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-sm",children:t.participantEmail})]}),t.participantPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Teléfono"}),e.jsx("p",{className:"text-sm",children:t.participantPhone})]}),t.age&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Edad"}),e.jsxs("p",{className:"text-sm",children:[t.age," años"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información de la Actividad"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Actividad"}),e.jsx("p",{className:"text-lg font-semibold",children:(oe=t.activity)==null?void 0:oe.title})]}),((xe=t.activity)==null?void 0:xe.startDate)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de inicio"}),e.jsxs("p",{className:"text-sm",children:[x(new Date(t.activity.startDate),"dd/MM/yyyy",{locale:g}),t.activity.startTime&&` a las ${t.activity.startTime}`]})]}),t.activity.endDate&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de fin"}),e.jsx("p",{className:"text-sm",children:x(new Date(t.activity.endDate),"dd/MM/yyyy",{locale:g})})]})]})]})]}),(t.emergencyContactName||t.emergencyPhone)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Contacto de Emergencia"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.emergencyContactName&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre"}),e.jsx("p",{className:"text-sm",children:t.emergencyContactName})]}),t.emergencyPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Teléfono"}),e.jsx("p",{className:"text-sm",children:t.emergencyPhone})]})]})]}),(t.medicalConditions||t.dietaryRestrictions)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información Médica"}),t.medicalConditions&&e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-yellow-800",children:"Condiciones médicas"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:t.medicalConditions})]}),t.dietaryRestrictions&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-blue-800",children:"Restricciones alimentarias"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:t.dietaryRestrictions})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Estado de la Inscripción"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Estado actual:"}),Q(t.status)]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de inscripción"}),e.jsx("p",{className:"text-sm",children:x(new Date(t.registrationDate),"dd/MM/yyyy HH:mm",{locale:g})})]}),t.rejectionReason&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-red-800",children:"Motivo de rechazo"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:t.rejectionReason})]}),t.notes&&e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Notas adicionales"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:t.notes})]})]}),t.status==="pending"&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(l,{onClick:()=>{y(t.id,"approved"),L(!1)},disabled:f.isPending,className:"bg-green-600 hover:bg-green-700 flex-1",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Aprobar Inscripción"]}),e.jsxs(l,{variant:"destructive",onClick:()=>{const s=prompt("Motivo del rechazo (opcional):");y(t.id,"rejected",s||void 0),L(!1)},disabled:f.isPending,className:"flex-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Rechazar Inscripción"]})]})]})]})]})})]}),e.jsx(Ne,{value:"summary",className:"space-y-6",children:Ze?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando resumen de actividades..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Resumen de Actividades"}),e.jsxs("p",{className:"text-gray-600",children:["Estadísticas detalladas de inscripciones por actividad (",$," total)"]})]}),e.jsxs("div",{className:"flex border rounded-lg p-1",children:[e.jsxs(l,{variant:O==="cards"?"default":"ghost",size:"sm",onClick:()=>ae("cards"),className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-4 w-4"}),"Tarjetas"]}),e.jsxs(l,{variant:O==="table"?"default":"ghost",size:"sm",onClick:()=>ae("table"),className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Lista"]})]})]})})}),j&&j.length>0?e.jsxs(e.Fragment,{children:[O==="cards"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:ce.map(s=>e.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(Se,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(Ee,{className:"text-lg line-clamp-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.category})]}),e.jsx(C,{variant:s.registrationEnabled?"default":"secondary",children:s.registrationEnabled?"Activa":"Cerrada"})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ys,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s.parkName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Me,{className:"h-3 w-3"}),e.jsx("span",{children:x(new Date(s.startDate),"dd/MM/yyyy",{locale:g})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ae,{className:"h-3 w-3"}),e.jsx("span",{children:s.startTime})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:"Estadísticas de Inscripciones"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.registrationStats.totalRegistrations}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.registrationStats.approved}),e.jsx("div",{className:"text-xs text-gray-600",children:"Aprobadas"})]}),e.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:s.registrationStats.pending}),e.jsx("div",{className:"text-xs text-gray-600",children:"Pendientes"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:s.registrationStats.availableSlots}),e.jsx("div",{className:"text-xs text-gray-600",children:"Disponibles"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Capacidad"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.registrationStats.totalRegistrations," / ",s.capacity||s.maxRegistrations||"Sin límite"]})]}),!s.isFree&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ingresos"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-green-600",children:["$",s.revenue.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Potencial: $",s.revenue.potentialRevenue.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Precio"}),e.jsx(C,{variant:s.isFree?"secondary":"outline",children:s.isFree?"Gratuita":`$${parseFloat(s.price).toLocaleString()}`})]})]})]},s.id))}),O==="table"&&e.jsx(r,{children:e.jsx(c,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Actividad"}),e.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Parque"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Total"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Aprobadas"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Pendientes"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Disponibles"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-900",children:"Ingresos"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Estado"})]})}),e.jsx("tbody",{children:ce.map((s,a)=>e.jsxs("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 line-clamp-1",children:s.title}),e.jsx("div",{className:"text-sm text-gray-600",children:s.category}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x(new Date(s.startDate),"dd/MM/yyyy",{locale:g})," - ",s.startTime]})]})}),e.jsx("td",{className:"p-4 text-sm text-gray-600",children:s.parkName}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:s.registrationStats.totalRegistrations})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:s.registrationStats.approved})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-orange-100 text-orange-800 rounded-full text-sm font-medium",children:s.registrationStats.pending})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-gray-100 text-gray-800 rounded-full text-sm font-medium",children:s.registrationStats.availableSlots})}),e.jsx("td",{className:"p-4 text-right",children:s.isFree?e.jsx("span",{className:"text-gray-500",children:"Gratuita"}):e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-green-600",children:["$",s.revenue.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Pot: $",s.revenue.potentialRevenue.toLocaleString()]})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx(C,{variant:s.registrationEnabled?"default":"secondary",children:s.registrationEnabled?"Activa":"Cerrada"})})]},s.id))})]})})})}),b>1&&e.jsx(r,{children:e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",H+1,"-",Math.min(re,$)," de ",$," actividades"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>B(s=>Math.max(s-1,1)),disabled:M===1,className:"flex items-center gap-1",children:[e.jsx(Re,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:b},(s,a)=>a+1).filter(s=>b<=7||s===1||s===b||Math.abs(s-M)<=1).map((s,a,i)=>e.jsxs(he.Fragment,{children:[a>0&&i[a-1]!==s-1&&e.jsx("span",{className:"px-2 text-gray-400",children:"..."}),e.jsx(l,{variant:M===s?"default":"outline",size:"sm",onClick:()=>B(s),className:"w-8 h-8 p-0",children:s})]},s))}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>B(s=>Math.min(s+1,b)),disabled:M===b,className:"flex items-center gap-1",children:["Siguiente",e.jsx(Te,{className:"h-4 w-4"})]})]})]})})})]}):e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ge,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin Actividades"}),e.jsx("p",{className:"text-gray-600",children:"No hay actividades disponibles para mostrar estadísticas."})]})})})]})})]}),e.jsx(Fe,{open:Qe,onOpenChange:U,children:e.jsxs(ze,{children:[e.jsxs(Ie,{children:[e.jsx(Le,{children:"¿Eliminar inscripción?"}),e.jsx(Oe,{children:"Esta acción eliminará permanentemente la inscripción seleccionada. Esta acción no se puede deshacer."})]}),e.jsxs($e,{children:[e.jsx(Ve,{children:"Cancelar"}),e.jsx(qe,{onClick:rs,disabled:K.isPending,className:"bg-red-600 hover:bg-red-700",children:K.isPending?"Eliminando...":"Eliminar"})]})]})}),e.jsx(Fe,{open:Xe,onOpenChange:_,children:e.jsxs(ze,{children:[e.jsxs(Ie,{children:[e.jsxs(Le,{children:["¿Eliminar ",d.length," inscripciones?"]}),e.jsxs(Oe,{children:["Esta acción eliminará permanentemente las ",d.length," inscripciones seleccionadas. Esta acción no se puede deshacer."]})]}),e.jsxs($e,{children:[e.jsx(Ve,{children:"Cancelar"}),e.jsx(qe,{onClick:ds,disabled:V.isPending,className:"bg-red-600 hover:bg-red-700",children:V.isPending?"Eliminando...":`Eliminar ${d.length} inscripciones`})]})]})})]})})};export{Cs as default};
