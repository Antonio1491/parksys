import{aH as z,l as K,az as L,a4 as N,u as Q,ar as H,j as e,bh as X,f as m,g as u,h as x,w as P,i as p,aa as G,ab as J,ac as W,V as t,B as h,b0 as _,a5 as $,W as S,Y as q,_ as D,$ as E,a0 as c,q as Z,X as k,M as ee,a1 as g}from"./index-BKCBrrzQ.js";import{F as A}from"./file-symlink-TOFqU66-.js";function le(){var F,w;const[se,v]=z(),{toast:o}=K(),y=L(),[M,R]=N.useState(null),[d,b]=N.useState(""),[a,T]=N.useState({firstName:"",lastName:"",email:"",phone:"",specialties:[],experienceYears:1,bio:"",preferredParkId:void 0,qualifications:"",availability:"",hourlyRate:0,experience:"",profileImageFile:null,curriculumFile:null}),{data:Y=[]}=Q({queryKey:["/api/parks"]}),j=H({mutationFn:async s=>{const i=new FormData,r={firstName:s.firstName,lastName:s.lastName,email:s.email,phone:s.phone||"",specialties:s.specialties,experienceYears:s.experienceYears,experience:s.experience||"",qualifications:s.qualifications||"",availability:s.availability||"",hourlyRate:s.hourlyRate||0,preferredParkId:s.preferredParkId||void 0};i.append("data",JSON.stringify(r)),s.profileImageFile&&i.append("profileImage",s.profileImageFile),s.curriculumFile&&i.append("curriculum",s.curriculumFile);const n=await fetch("/api/instructors",{method:"POST",body:i});if(!n.ok){const f=await n.json();throw new Error(f.message||"Error al crear instructor")}return n.json()},onSuccess:()=>{o({title:"Instructor creado exitosamente",description:"El instructor ha sido registrado y su usuario ha sido creado automáticamente."}),y.invalidateQueries({queryKey:["/api/instructors"]}),y.invalidateQueries({queryKey:["/public-api/instructors/public"]}),v("/admin/activities/instructors")},onError:s=>{o({title:"Error al crear instructor",description:s.message,variant:"destructive"})}}),l=(s,i)=>{T(r=>({...r,[s]:i}))},B=s=>{var r;const i=(r=s.target.files)==null?void 0:r[0];if(i){const n=new FileReader;n.onload=f=>{var I;return R((I=f.target)==null?void 0:I.result)},n.readAsDataURL(i),l("profileImageFile",i)}},U=s=>{var r;const i=(r=s.target.files)==null?void 0:r[0];i&&l("curriculumFile",i)},C=()=>{if(d.trim()&&!a.specialties.includes(d.trim())){const s=[...a.specialties,d.trim()];l("specialties",s),b("")}},V=s=>{const i=a.specialties.filter(r=>r!==s);l("specialties",i)},O=s=>{if(s.preventDefault(),!a.firstName||!a.lastName||!a.email){o({title:"Campos requeridos",description:"Por favor completa los campos de nombre, apellido y email.",variant:"destructive"});return}if(a.specialties.length===0){o({title:"Especialidades requeridas",description:"Por favor agrega al menos una especialidad.",variant:"destructive"});return}j.mutate(a)};return e.jsx(X,{title:"Nuevo Instructor",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Nuevo Instructor"}),e.jsx("p",{className:"text-gray-600",children:"Registra un nuevo instructor para las actividades de los parques."})]}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(P,{className:"mr-2 h-5 w-5"}),"Foto de Perfil"]})}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs(G,{className:"h-32 w-32",children:[e.jsx(J,{src:M||void 0}),e.jsxs(W,{className:"text-2xl",children:[(F=a.firstName)==null?void 0:F[0],(w=a.lastName)==null?void 0:w[0]]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{type:"file",accept:"image/*",onChange:B,className:"hidden",id:"profile-image"}),e.jsx("label",{htmlFor:"profile-image",children:e.jsx(h,{type:"button",variant:"outline",size:"sm",asChild:!0,children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Subir foto"]})})})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Formatos: JPG, PNG. Máx: 5MB"})]})})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(P,{className:"mr-2 h-5 w-5"}),"Información Personal"]})}),e.jsxs(p,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"firstName",className:"text-sm font-medium",children:"Nombre *"}),e.jsx(t,{id:"firstName",placeholder:"Nombre del instructor",value:a.firstName,onChange:s=>l("firstName",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"lastName",className:"text-sm font-medium",children:"Apellido *"}),e.jsx(t,{id:"lastName",placeholder:"Apellido del instructor",value:a.lastName,onChange:s=>l("lastName",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email *"}),e.jsx(t,{id:"email",type:"email",placeholder:"email@ejemplo.com",value:a.email,onChange:s=>l("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"phone",className:"text-sm font-medium",children:"Teléfono"}),e.jsx(t,{id:"phone",placeholder:"(33) 1234-5678",value:a.phone,onChange:s=>l("phone",s.target.value)})]})]})]}),e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx($,{className:"mr-2 h-5 w-5"}),"Información Profesional"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"experienceYears",className:"text-sm font-medium",children:"Años de Experiencia"}),e.jsx(t,{id:"experienceYears",type:"number",min:"0",max:"50",value:a.experienceYears,onChange:s=>l("experienceYears",parseInt(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"hourlyRate",className:"text-sm font-medium",children:"Tarifa por Hora (MXN)"}),e.jsx(t,{id:"hourlyRate",type:"number",min:"0",placeholder:"0",value:a.hourlyRate,onChange:s=>l("hourlyRate",parseFloat(s.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"availability",className:"text-sm font-medium",children:"Disponibilidad"}),e.jsxs(S,{onValueChange:s=>l("availability",s),children:[e.jsx(q,{children:e.jsx(D,{placeholder:"Selecciona disponibilidad"})}),e.jsxs(E,{children:[e.jsx(c,{value:"full-time",children:"Tiempo completo"}),e.jsx(c,{value:"part-time",children:"Medio tiempo"}),e.jsx(c,{value:"weekends",children:"Fines de semana"}),e.jsx(c,{value:"evenings",children:"Tardes"}),e.jsx(c,{value:"mornings",children:"Mañanas"}),e.jsx(c,{value:"flexible",children:"Flexible"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Especialidades *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(t,{placeholder:"Ej: Yoga, Danza, Deportes acuáticos",value:d,onChange:s=>b(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),C())}),e.jsx(h,{type:"button",onClick:C,variant:"outline",children:"Agregar"})]}),a.specialties.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:a.specialties.map((s,i)=>e.jsxs(Z,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587]",children:[s,e.jsx("button",{type:"button",onClick:()=>V(s),className:"ml-2 hover:text-red-600",children:e.jsx(k,{className:"h-3 w-3"})})]},i))})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Agrega las especialidades una por una"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"curriculumFile",className:"text-sm font-medium",children:"Curriculum Vitae"}),e.jsx("div",{className:"border border-gray-300 rounded-md p-4 bg-gray-50",children:a.curriculumFile?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 truncate max-w-[200px]",children:a.curriculumFile.name})]}),e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700",onClick:()=>l("curriculumFile",null),children:e.jsx(k,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("label",{htmlFor:"curriculumUpload",className:"cursor-pointer inline-flex items-center gap-2 py-2 px-4 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(A,{className:"h-4 w-4"}),"Subir CV",e.jsx("input",{id:"curriculumUpload",type:"file",accept:".pdf,.doc,.docx",className:"hidden",onChange:U})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formatos: PDF, DOC, DOCX. Máx: 5MB"})]})})]})]})]}),e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(x,{className:"flex items-center",children:[e.jsx(ee,{className:"mr-2 h-5 w-5"}),"Información Adicional"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"preferredParkId",className:"text-sm font-medium",children:"Parque Preferido (Opcional)"}),e.jsxs(S,{onValueChange:s=>l("preferredParkId",parseInt(s)),children:[e.jsx(q,{children:e.jsx(D,{placeholder:"Selecciona un parque"})}),e.jsx(E,{children:Y.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"El parque donde el instructor prefiere dar sus actividades"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"qualifications",className:"text-sm font-medium",children:"Certificaciones y Cualificaciones"}),e.jsx(g,{id:"qualifications",placeholder:"Describe las certificaciones, títulos o cualificaciones del instructor...",value:a.qualifications,onChange:s=>l("qualifications",s.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"experience",className:"text-sm font-medium",children:"Experiencia Profesional"}),e.jsx(g,{id:"experience",placeholder:"Describe la experiencia profesional, logros y áreas de especialización...",value:a.experience,onChange:s=>l("experience",s.target.value),rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"bio",className:"text-sm font-medium",children:"Biografía"}),e.jsx(g,{id:"bio",placeholder:"Describe la filosofía y enfoque del instructor...",value:a.bio,onChange:s=>l("bio",s.target.value),rows:3}),e.jsx("p",{className:"text-xs text-gray-500",children:"Esta información será visible en el perfil público del instructor"})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>v("/admin/activities/instructors"),children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:j.isPending,className:"bg-[#00a587] hover:bg-[#067f5f]",children:j.isPending?"Creando...":"Crear Instructor"})]})]})]})})}export{le as default};
