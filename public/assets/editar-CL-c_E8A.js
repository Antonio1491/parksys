import{ay as r,aH as ee,k as ae,u as w,aA as ie,a4 as se,ar as re,j as e,bh as H,f as U,i as Q,B as A,g as ne,h as te,bC as ce,ad as oe,aI as le,aJ as n,aK as t,aL as c,aM as o,V as j,aN as l,W as E,Y as M,_ as F,$ as _,a0 as q,a1 as L,aQ as u,cV as P,aP as T,aB as de,cU as O}from"./index-BKCBrrzQ.js";import{S as $}from"./switch-B8yCKxVc.js";const ue=[{id:"lunes",label:"Lunes"},{id:"martes",label:"Martes"},{id:"miercoles",label:"MiÃ©rcoles"},{id:"jueves",label:"Jueves"},{id:"viernes",label:"Viernes"},{id:"sabado",label:"SÃ¡bado"},{id:"domingo",label:"Domingo"}],me=[{id:"preescolar",label:"Preescolar - 0 a 5 aÃ±os"},{id:"ninos",label:"NiÃ±os - 6 a 12 aÃ±os"},{id:"adolescentes",label:"Adolescentes - 13 a 18 aÃ±os"},{id:"adultos",label:"Adultos - 19 a 65 aÃ±os"},{id:"adultosmayores",label:"Adultos Mayores - +65 aÃ±os"}],xe=[{id:"fisica",label:"FÃ­sica / Motriz"},{id:"visual",label:"Visual"},{id:"auditiva",label:"Auditiva"},{id:"intelectual",label:"Intelectual / Cognitiva"},{id:"psicosocial",label:"Psicosocial / Mental"},{id:"neurodivergencias",label:"Neurodivergencias"},{id:"multiple",label:"MÃºltiple / Combinada"},{id:"temporal",label:"Temporal"}],pe=[{id:"activa",label:"ðŸŸ¢ Activa",emoji:"ðŸŸ¢"},{id:"programada",label:"ðŸŸ¡ Programada",emoji:"ðŸŸ¡"},{id:"cancelada",label:"ðŸ”´ Cancelada",emoji:"ðŸ”´"},{id:"finalizada",label:"âš« Finalizada",emoji:"âš«"},{id:"en_pausa",label:"ðŸŸ  En Pausa",emoji:"ðŸŸ "}],he=r.object({title:r.string().min(3,"El tÃ­tulo debe tener al menos 3 caracteres"),description:r.string().min(10,"La descripciÃ³n debe tener al menos 10 caracteres"),category:r.string().min(1,"Debes seleccionar una categorÃ­a"),parkId:r.string().min(1,"Debes seleccionar un parque"),startDate:r.string().min(1,"La fecha de inicio es obligatoria"),endDate:r.string().optional(),startTime:r.string().min(1,"La hora de inicio es obligatoria"),endTime:r.string().min(1,"La hora de finalizaciÃ³n es obligatoria"),location:r.string().optional(),latitude:r.coerce.number().optional(),longitude:r.coerce.number().optional(),capacity:r.coerce.number().int().positive().optional(),duration:r.coerce.number().int().positive().optional(),price:r.coerce.number().min(0).optional(),isPriceRandom:r.boolean().default(!1),isFree:r.boolean().default(!1),materials:r.string().optional(),requirements:r.string().optional(),isRecurring:r.boolean().default(!1),recurringDays:r.array(r.string()).optional(),targetMarket:r.array(r.string()).optional(),specialNeeds:r.array(r.string()).optional(),instructorId:r.string().optional(),allowsPublicRegistration:r.boolean().default(!1),maxRegistrations:r.coerce.number().int().positive().optional(),registrationDeadline:r.string().optional(),registrationInstructions:r.string().optional(),requiresApproval:r.boolean().default(!1),ageRestrictions:r.string().optional(),healthRequirements:r.string().optional(),status:r.string().default("programada")});function B(S,g){const[v,b,D]=S.split("-"),[I,y]=g.split(":");return new Date(parseInt(v),parseInt(b)-1,parseInt(D),parseInt(I),parseInt(y)).toISOString()}function G(S,g){if(!S||!g)return 0;const[v,b]=S.split(":").map(Number),[D,I]=g.split(":").map(Number),y=v*60+b;let N=D*60+I;return N<=y&&(N+=24*60),N-y}const be=()=>{var K;const[S,g]=ee(),v=ae(),b=v==null?void 0:v.id,{data:D=[],isLoading:I}=w({queryKey:["/api/parks"]}),{data:y=[],isLoading:N}=w({queryKey:["/api/activity-categories"]}),{data:k=[],isLoading:J}=w({queryKey:["/api/instructors"]}),{data:f,isLoading:Y}=w({queryKey:[`/api/activities/${b}`],enabled:!!b}),s=ie({resolver:de(he),defaultValues:{title:"",description:"",category:"",parkId:"",startDate:"",endDate:"",startTime:"09:00",endTime:"10:00",location:"",latitude:void 0,longitude:void 0,capacity:void 0,duration:60,price:0,isPriceRandom:!1,isFree:!1,materials:"",requirements:"",isRecurring:!1,recurringDays:[],targetMarket:[],specialNeeds:[],instructorId:"",allowsPublicRegistration:!1,maxRegistrations:void 0,registrationDeadline:"",registrationInstructions:"",requiresApproval:!1,ageRestrictions:"",healthRequirements:"",status:"programada"}});se.useEffect(()=>{if(f){const a=f;let i="",d="09:00";if(a.startDate){const m=a.startDate.toString();if(m.includes("T")){const C=new Date(m);i=C.toISOString().split("T")[0],d=C.toTimeString().substring(0,5)}else if(m.includes(" ")){const[C,R]=m.split(" ");i=C,R&&(d=R.substring(0,5))}else i=m}a.startTime&&(d=a.startTime);let x=a.endTime||"10:00";if(!a.endTime&&a.duration){const[m,C]=d.split(":").map(Number),R=m*60+C+(a.duration||60),X=Math.floor(R/60)%24,Z=R%60;x=`${X.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`}let h="";if(a.endDate){const m=a.endDate.toString();m.includes("T")?h=new Date(m).toISOString().split("T")[0]:m.includes(" ")?h=m.split(" ")[0]:h=m}let p="";if(a.registrationDeadline){const m=a.registrationDeadline.toString();m.includes("T")?p=new Date(m).toISOString().split("T")[0]:m.includes(" ")?p=m.split(" ")[0]:p=m}const z={title:a.title||"",description:a.description||"",category:a.categoryId?a.categoryId.toString():a.category_id?a.category_id.toString():"",parkId:a.parkId?a.parkId.toString():a.park_id?a.park_id.toString():"",startDate:i,endDate:h,startTime:d,endTime:x,location:a.location||"",latitude:a.latitude||void 0,longitude:a.longitude||void 0,capacity:a.capacity||void 0,duration:a.duration||G(d,x),price:a.price?parseFloat(a.price):0,isPriceRandom:a.isPriceRandom||a.is_price_random||!1,isFree:a.isFree||a.is_free||a.price===null||a.price===0||a.price==="0",materials:a.materials||"",requirements:a.requirements||"",isRecurring:a.isRecurring||a.is_recurring||!1,recurringDays:a.recurringDays||a.recurring_days||[],targetMarket:a.targetMarket||a.target_market||[],specialNeeds:a.specialNeeds||a.special_needs||[],instructorId:a.instructorId?a.instructorId.toString():a.instructor_id?a.instructor_id.toString():"",allowsPublicRegistration:a.allowsPublicRegistration||a.allows_public_registration||a.registrationEnabled||a.registration_enabled||!1,maxRegistrations:a.maxRegistrations||a.max_registrations||void 0,registrationDeadline:p,registrationInstructions:a.registrationInstructions||a.registration_instructions||"",requiresApproval:a.requiresApproval||a.requires_approval||!1,ageRestrictions:a.ageRestrictions||a.age_restrictions||"",healthRequirements:a.healthRequirements||a.health_requirements||"",status:a.status||"programada"};s.reset(z)}},[f,s]);const V=re({mutationFn:async a=>{var h;console.log("Enviando datos de ediciÃ³n:",a),console.log("ðŸ” STATUS ESPECÃFICO enviado:",{status:a.status,statusType:typeof a.status,statusLength:(h=a.status)==null?void 0:h.length});let i={};if(a.instructorId){const p=k.find(z=>z.id.toString()===a.instructorId);p&&(i={instructorId:p.id,instructorName:`${p.fullName||p.username||""}`.trim(),instructorContact:p.email||""})}const d={title:a.title,description:a.description,categoryId:parseInt(a.category),parkId:parseInt(a.parkId),startDate:B(a.startDate,a.startTime),endDate:a.endDate?B(a.endDate,a.endTime):null,startTime:a.startTime,endTime:a.endTime,location:a.location,latitude:a.latitude,longitude:a.longitude,capacity:a.capacity,duration:a.duration,price:a.price,isPriceRandom:a.isPriceRandom,isFree:a.isFree,materials:a.materials,requirements:a.requirements,isRecurring:a.isRecurring,recurringDays:a.recurringDays,targetMarket:a.targetMarket,specialNeeds:a.specialNeeds,...i,allowsPublicRegistration:a.allowsPublicRegistration,maxRegistrations:a.maxRegistrations,registrationDeadline:a.registrationDeadline,registrationInstructions:a.registrationInstructions,requiresApproval:a.requiresApproval,ageRestrictions:a.ageRestrictions,healthRequirements:a.healthRequirements,status:a.status},x=await fetch(`/api/activities/${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!x.ok){const p=await x.text();throw new Error(`Error ${x.status}: ${p}`)}return x.json()},onSuccess:()=>{P({title:"Â¡Ã‰xito!",description:"La actividad ha sido actualizada correctamente."}),O.invalidateQueries({queryKey:["/api/activities"]}),O.invalidateQueries({queryKey:[`/api/activities/${b}`]}),O.invalidateQueries({queryKey:["/api/actividades-fotos"]}),g("/admin/activities/management")},onError:a=>{console.error("Error al actualizar actividad:",a),P({title:"Error",description:`No se pudo actualizar la actividad: ${a.message}`,variant:"destructive"})}}),W=a=>{V.mutate(a)};return Y||I||N||J?e.jsx(H,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4",children:"Cargando datos de la actividad..."})]})})}):f?e.jsx(H,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(U,{children:[e.jsxs(ne,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Editar Actividad"]}),e.jsx(oe,{children:"Modifica los detalles de la actividad seleccionada"})]}),e.jsx(Q,{className:"space-y-6",children:e.jsx(le,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(W),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"InformaciÃ³n BÃ¡sica"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{control:s.control,name:"title",render:({field:a})=>e.jsxs(t,{className:"md:col-span-2",children:[e.jsx(c,{children:"TÃ­tulo *"}),e.jsx(o,{children:e.jsx(j,{placeholder:"Ej: Yoga en el parque",...a})}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"status",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Estado"}),e.jsxs(E,{onValueChange:a.onChange,value:a.value||void 0,children:[e.jsx(o,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Selecciona estado"})})}),e.jsx(_,{children:pe.map(i=>e.jsx(q,{value:i.id,children:i.label},i.id))})]}),e.jsx(l,{})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx(n,{control:s.control,name:"category",render:({field:a})=>(y.find(i=>i.id.toString()===a.value),e.jsxs(t,{children:[e.jsx(c,{children:"CategorÃ­a *"}),e.jsxs(E,{onValueChange:a.onChange,value:a.value||void 0,children:[e.jsx(o,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Selecciona una categorÃ­a"})})}),e.jsx(_,{children:y.map(i=>e.jsx(q,{value:i.id.toString(),children:i.name||i.nombre},i.id))})]}),e.jsx(l,{})]}))})}),e.jsx(n,{control:s.control,name:"description",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"DescripciÃ³n *"}),e.jsx(o,{children:e.jsx(L,{placeholder:"Describe la actividad, quÃ© se harÃ¡, objetivos, etc.",className:"min-h-[100px]",...a})}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"UbicaciÃ³n"}),e.jsx(n,{control:s.control,name:"parkId",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Parque *"}),e.jsxs(E,{onValueChange:a.onChange,value:a.value||void 0,children:[e.jsx(o,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Selecciona un parque"})})}),e.jsx(_,{children:D.map(i=>e.jsx(q,{value:i.id.toString(),children:i.nombre||i.name},i.id))})]}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"location",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"UbicaciÃ³n especÃ­fica"}),e.jsx(o,{children:e.jsx(j,{placeholder:"Ej: Ãrea de juegos, Cancha de fÃºtbol, Junto al lago",...a})}),e.jsx(u,{children:"Especifica dÃ³nde exactamente dentro del parque se realizarÃ¡ la actividad"}),e.jsx(l,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"latitude",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Latitud (GPS)"}),e.jsx(o,{children:e.jsx(j,{type:"number",step:"any",placeholder:"Ej: 20.676667",...a,onChange:i=>a.onChange(i.target.value?parseFloat(i.target.value):void 0),value:a.value||""})}),e.jsx(u,{children:"Coordenada de latitud para ubicaciÃ³n GPS precisa"}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"longitude",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Longitud (GPS)"}),e.jsx(o,{children:e.jsx(j,{type:"number",step:"any",placeholder:"Ej: -103.342222",...a,onChange:i=>a.onChange(i.target.value?parseFloat(i.target.value):void 0),value:a.value||""})}),e.jsx(u,{children:"Coordenada de longitud para ubicaciÃ³n GPS precisa"}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(A,{type:"button",variant:"outline",onClick:()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{s.setValue("latitude",a.coords.latitude),s.setValue("longitude",a.coords.longitude),P({title:"UbicaciÃ³n obtenida",description:"Las coordenadas GPS han sido establecidas automÃ¡ticamente."})},a=>{P({title:"Error",description:"No se pudo obtener la ubicaciÃ³n. Por favor ingresa las coordenadas manualmente.",variant:"destructive"})}):P({title:"No soportado",description:"Tu navegador no soporta la geolocalizaciÃ³n.",variant:"destructive"})},className:"w-full",children:"ðŸ“ Obtener UbicaciÃ³n Actual"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Haz clic para obtener automÃ¡ticamente tu ubicaciÃ³n GPS actual"})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"SegmentaciÃ³n"}),e.jsx(n,{control:s.control,name:"targetMarket",render:()=>e.jsxs(t,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:"Mercado Meta"}),e.jsx(u,{children:"Selecciona los grupos de edad a los que estÃ¡ dirigida esta actividad"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:me.map(a=>e.jsx(n,{control:s.control,name:"targetMarket",render:({field:i})=>{var d;return e.jsxs(t,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx(T,{checked:(d=i.value)==null?void 0:d.includes(a.id),onCheckedChange:x=>{var h;return x?i.onChange([...i.value||[],a.id]):i.onChange((h=i.value)==null?void 0:h.filter(p=>p!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]},a.id)}},a.id))}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Capacidades Diferentes"}),e.jsx(n,{control:s.control,name:"specialNeeds",render:()=>e.jsxs(t,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:"Accesibilidad para personas con capacidades diferentes"}),e.jsx(u,{children:"Selecciona los tipos de discapacidad para los que esta actividad estÃ¡ adaptada"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:xe.map(a=>e.jsx(n,{control:s.control,name:"specialNeeds",render:({field:i})=>{var d;return e.jsxs(t,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx(T,{checked:(d=i.value)==null?void 0:d.includes(a.id),onCheckedChange:x=>{var h;return x?i.onChange([...i.value||[],a.id]):i.onChange((h=i.value)==null?void 0:h.filter(p=>p!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]},a.id)}},a.id))}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Fecha y Horario"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"startDate",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Fecha de inicio *"}),e.jsx(o,{children:e.jsx(j,{type:"date",...a})}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"endDate",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Fecha de finalizaciÃ³n"}),e.jsx(o,{children:e.jsx(j,{type:"date",...a})}),e.jsx(u,{children:"Opcional para actividades de un solo dÃ­a"}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"startTime",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Hora de inicio *"}),e.jsx(o,{children:e.jsx(j,{type:"time",...a,onChange:i=>{a.onChange(i);const d=s.getValues("endTime");if(d){const x=G(i.target.value,d);s.setValue("duration",x)}}})}),e.jsx(u,{children:"Hora a la que comenzarÃ¡ la actividad"}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"endTime",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Hora de finalizaciÃ³n *"}),e.jsx(o,{children:e.jsx(j,{type:"time",...a,onChange:i=>{a.onChange(i);const d=s.getValues("startTime");if(d){const x=G(d,i.target.value);s.setValue("duration",x)}}})}),e.jsx(u,{children:"Hora a la que terminarÃ¡ la actividad"}),e.jsx(l,{})]})})]}),e.jsx(n,{control:s.control,name:"duration",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"DuraciÃ³n (minutos)"}),e.jsx(o,{children:e.jsx(j,{type:"number",min:"0",placeholder:"Se calcula automÃ¡ticamente",...a,disabled:!0})}),e.jsx(u,{children:"Se calcula automÃ¡ticamente basado en la hora de inicio y finalizaciÃ³n"}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"isRecurring",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Actividad recurrente"}),e.jsx(u,{children:"Marca esta opciÃ³n si la actividad se repite en dÃ­as especÃ­ficos"})]}),e.jsx(o,{children:e.jsx($,{checked:a.value,onCheckedChange:a.onChange})})]})}),s.watch("isRecurring")&&e.jsx(n,{control:s.control,name:"recurringDays",render:()=>e.jsxs(t,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:"DÃ­as de la semana"}),e.jsx(u,{children:"Selecciona los dÃ­as en que se repite la actividad"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:ue.map(a=>e.jsx(n,{control:s.control,name:"recurringDays",render:({field:i})=>{var d;return e.jsxs(t,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx(T,{checked:(d=i.value)==null?void 0:d.includes(a.id),onCheckedChange:x=>{var h;return x?i.onChange([...i.value||[],a.id]):i.onChange((h=i.value)==null?void 0:h.filter(p=>p!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]},a.id)}},a.id))}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Capacidad y Materiales"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"capacity",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Capacidad mÃ¡xima"}),e.jsx(o,{children:e.jsx(j,{type:"number",min:"0",placeholder:"Ej: 20",...a,onChange:i=>a.onChange(i.target.value?parseInt(i.target.value):void 0),value:a.value||""})}),e.jsx(u,{children:"NÃºmero mÃ¡ximo de participantes permitidos"}),e.jsx(l,{})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{control:s.control,name:"price",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Precio (MXN)"}),e.jsx(o,{children:e.jsx(j,{type:"number",min:"0",step:"0.01",placeholder:"Ej: 50.00",...a,disabled:s.watch("isFree")||s.watch("isPriceRandom")})}),e.jsx(u,{children:s.watch("isFree")?"Actividad gratuita":s.watch("isPriceRandom")?"El precio serÃ¡ variable o por donativo":"Precio fijo por persona"}),e.jsx(l,{})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsx(n,{control:s.control,name:"isFree",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx(T,{checked:a.value,onCheckedChange:i=>{a.onChange(i),i&&(s.setValue("price",0),s.setValue("isPriceRandom",!1))}})}),e.jsx(c,{className:"font-medium",children:"Actividad Gratuita"})]})}),e.jsx(n,{control:s.control,name:"isPriceRandom",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(o,{children:e.jsx(T,{checked:a.value,onCheckedChange:i=>{a.onChange(i),i&&s.setValue("isFree",!1)}})}),e.jsx(c,{className:"font-medium",children:"Precio Aleatorio (Donativo/Variable)"})]})})]})]})]}),e.jsx(n,{control:s.control,name:"materials",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Materiales necesarios"}),e.jsx(o,{children:e.jsx(L,{placeholder:"Lista de materiales que se usarÃ¡n o que deben traer los participantes",...a})}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"requirements",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Requisitos para participantes"}),e.jsx(o,{children:e.jsx(L,{placeholder:"Requisitos especiales, rango de edad, condiciones fÃ­sicas, etc.",...a})}),e.jsx(l,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"ConfiguraciÃ³n de Registro Ciudadano"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configura si los ciudadanos pueden inscribirse a esta actividad desde el sitio pÃºblico"}),e.jsx(n,{control:s.control,name:"allowsPublicRegistration",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Permitir inscripciÃ³n pÃºblica"}),e.jsx(u,{children:"Los ciudadanos podrÃ¡n inscribirse a esta actividad desde la pÃ¡gina pÃºblica"})]}),e.jsx(o,{children:e.jsx($,{checked:a.value,onCheckedChange:a.onChange})})]})}),s.watch("allowsPublicRegistration")&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"maxRegistrations",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Capacidad mÃ¡xima de inscripciones"}),e.jsx(o,{children:e.jsx(j,{type:"number",placeholder:"Ej: 25",...a,value:a.value||"",onChange:i=>a.onChange(i.target.value?parseInt(i.target.value):void 0)})}),e.jsx(u,{children:"NÃºmero mÃ¡ximo de personas que se pueden inscribir. Se recomienda que coincida con el nÃºmero mÃ¡ximo escrito en la secciÃ³n de Capacidad y Materiales."}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"registrationDeadline",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Fecha lÃ­mite de inscripciÃ³n"}),e.jsx(o,{children:e.jsx(j,{type:"date",...a,value:a.value||""})}),e.jsx(u,{children:"Fecha despuÃ©s de la cual no se aceptan inscripciones"}),e.jsx(l,{})]})})]}),e.jsx(n,{control:s.control,name:"registrationInstructions",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Instrucciones para inscripciÃ³n"}),e.jsx(o,{children:e.jsx(L,{placeholder:"Instrucciones especÃ­ficas para los participantes al inscribirse",...a,value:a.value||""})}),e.jsx(u,{children:"InformaciÃ³n adicional que verÃ¡n los ciudadanos al inscribirse"}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"requiresApproval",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Requiere aprobaciÃ³n administrativa"}),e.jsx(u,{children:"Las inscripciones deben ser aprobadas manualmente por un administrador"})]}),e.jsx(o,{children:e.jsx($,{checked:a.value,onCheckedChange:a.onChange})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{control:s.control,name:"ageRestrictions",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Restricciones de edad"}),e.jsx(o,{children:e.jsx(j,{placeholder:"Ej: 18-65 aÃ±os, Menores acompaÃ±ados",...a,value:a.value||""})}),e.jsx(u,{children:"Restricciones especÃ­ficas de edad para participar"}),e.jsx(l,{})]})}),e.jsx(n,{control:s.control,name:"healthRequirements",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Requisitos de salud"}),e.jsx(o,{children:e.jsx(j,{placeholder:"Ej: Certificado mÃ©dico, buena condiciÃ³n fÃ­sica",...a,value:a.value||""})}),e.jsx(u,{children:"Requisitos mÃ©dicos o de salud para participar"}),e.jsx(l,{})]})})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Datos del Instructor o Facilitador"}),e.jsx(n,{control:s.control,name:"instructorId",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Seleccionar Instructor"}),e.jsxs(E,{onValueChange:a.onChange,value:a.value,children:[e.jsx(o,{children:e.jsx(M,{children:e.jsx(F,{placeholder:"Selecciona un instructor"})})}),e.jsx(_,{children:k.length===0?e.jsx(q,{value:"no-instructors",disabled:!0,children:"No hay instructores disponibles"}):k.map(i=>e.jsxs(q,{value:i.id.toString(),children:[i.firstName," ",i.lastName," (",i.email,")"]},i.id))})]}),e.jsx(u,{children:"Selecciona un instructor registrado en el sistema. Si el instructor que buscas no estÃ¡ en la lista, primero debes registrarlo en la secciÃ³n de Usuarios."}),e.jsx(l,{})]})}),k.length===0&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4 my-4",children:e.jsx("p",{className:"text-amber-800",children:"No hay instructores registrados en el sistema. DirÃ­gete a la secciÃ³n de Instructores en este mÃ³dulo de Actividades, para crear un Instructor primero."})})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(A,{type:"button",variant:"outline",onClick:()=>g("/admin/organizador/catalogo/ver"),children:"Cancelar"}),e.jsx(A,{type:"submit",disabled:V.isPending,children:V.isPending?"Guardando...":"Actualizar Actividad"})]})})]},(K=f==null?void 0:f.data)==null?void 0:K.id)})})]})})}):e.jsx(H,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(U,{children:e.jsxs(Q,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-600",children:"No se encontrÃ³ la actividad solicitada."}),e.jsx(A,{onClick:()=>g("/admin/organizador/catalogo/ver"),className:"mt-4",children:"Volver al catÃ¡logo"})]})})})})};export{be as default};
