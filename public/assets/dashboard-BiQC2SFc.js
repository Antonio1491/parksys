const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard-charts-BuB3nIK6.js","assets/index-BKCBrrzQ.js","assets/index-ViLwfWCw.css","assets/RadarChart-D0BEKayc.js","assets/BarChart-CGQMqZFp.js"])))=>i.map(i=>d[i]);
import{c as F,R as m,bA as K,aH as H,u as N,j as e,bh as J,B as T,A as Q,bB as U,f as n,i,al as y,p as b,bw as W,g as x,h,ad as u,cW as j,b5 as w,bO as L,q as z,M as _,v as B,a3 as G}from"./index-BKCBrrzQ.js";import{G as X}from"./graphic-card-DqEiXv3p.js";import{A as P}from"./arrow-up-right-DxfT3JuB.js";import{A as k}from"./arrow-down-right-idafaPP5.js";import{s as Y}from"./subMonths-CWHOHbgb.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=F("SquareStack",[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]),p=m.lazy(()=>K(()=>import("./dashboard-charts-BuB3nIK6.js"),__vite__mapDeps([0,1,2,3,4]))),ce=()=>{const[ee,D]=H(),M=new Date;Y(M,1);const $=s=>B(s,"MMMM yyyy",{locale:G}),{data:a={total:0,pending:0,inProgress:0,resolved:0,rejected:0,byPriority:{low:0,medium:0,high:0,critical:0},byCategory:[],byPark:[],byMonth:[],resolutionTime:0,mostRecentIncidents:[]},isLoading:se,isError:ae}=N({queryKey:["/api/incidents/stats"],onError:s=>{console.error("Error al cargar estadísticas:",s)}}),{data:V=[]}=N({queryKey:["/api/incident-categories"],onError:s=>{console.error("Error al cargar categorías:",s)}}),{data:O=[]}=N({queryKey:["/api/parks"],onError:s=>{console.error("Error al cargar parques:",s)}}),c=m.useMemo(()=>{var d,I,E,S;const s=[{name:"Pendientes",value:a.pending||12,color:"#fbbf24"},{name:"En proceso",value:a.inProgress||18,color:"#3b82f6"},{name:"Resueltas",value:a.resolved||34,color:"#22c55e"},{name:"Rechazadas",value:a.rejected||8,color:"#ef4444"}],t=[{name:"Baja",value:((d=a.byPriority)==null?void 0:d.low)||15,color:"#3b82f6"},{name:"Media",value:((I=a.byPriority)==null?void 0:I.medium)||25,color:"#fbbf24"},{name:"Alta",value:((E=a.byPriority)==null?void 0:E.high)||20,color:"#f97316"},{name:"Crítica",value:((S=a.byPriority)==null?void 0:S.critical)||12,color:"#ef4444"}],r=a.byCategory&&a.byCategory.length>0?a.byCategory.map(o=>({name:o.name,value:o.count,color:o.color||"#3b82f6"})):[{name:"Daños",value:24,color:"#3b82f6"},{name:"Seguridad",value:18,color:"#f97316"},{name:"Mantenimiento",value:15,color:"#22c55e"},{name:"Vandalismo",value:9,color:"#ef4444"},{name:"Otros",value:6,color:"#a855f7"}],v=a.byPark&&a.byPark.length>0?a.byPark.map(o=>({name:o.name||`Parque ${o.id}`,value:o.count})):[{name:"Parque Metropolitano",value:28},{name:"Parque Agua Azul",value:22},{name:"Parque González Gallo",value:16},{name:"Parque Colomos",value:14},{name:"Otros parques",value:12}],g=a.byMonth&&a.byMonth.length>0?a.byMonth:[{name:"Ene",pending:5,inProgress:8,resolved:12},{name:"Feb",pending:7,inProgress:10,resolved:15},{name:"Mar",pending:4,inProgress:12,resolved:18},{name:"Abr",pending:8,inProgress:9,resolved:20},{name:"May",pending:10,inProgress:15,resolved:25},{name:"Jun",pending:12,inProgress:18,resolved:30}];return{statusData:s,priorityData:t,categoryData:r,parkData:v,monthlyData:g}},[a,V,O]),f=(s,t)=>t===0?100:Math.round((s-t)/t*100),l={total:f(a.total||72,65),resolved:f(a.resolved||34,29),avgResolutionTime:f(a.resolutionTime||3.2,3.8)},C=s=>B(new Date(s),"d MMM yyyy",{locale:G}),q=s=>({pending:"Pendiente",in_progress:"En proceso",resolved:"Resuelto",rejected:"Rechazado"})[s]||s,A=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-700";case"in_progress":return"bg-blue-100 text-blue-700";case"resolved":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},R=s=>{switch(s){case"pending":return e.jsx(w,{className:"h-4 w-4 text-yellow-500"});case"in_progress":return e.jsx(b,{className:"h-4 w-4 text-blue-500"});case"resolved":return e.jsx(y,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(L,{className:"h-4 w-4 text-red-500"});default:return null}};return e.jsx(J,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(T,{variant:"ghost",className:"mb-4",onClick:()=>D("/admin/incidents"),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Volver a incidencias"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Panel de control de incidencias"}),e.jsx("p",{className:"text-gray-500",children:"Estadísticas y métricas clave para la gestión de incidencias"})]}),e.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx(U,{className:"h-4 w-4 inline-block mr-1"}),"Datos actualizados: ",$(M)]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total de incidencias"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:a.total||72}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.total>=0?"text-green-600":"text-red-600"}`,children:[l.total>=0?e.jsx(P,{className:"h-3 w-3 mr-1"}):e.jsx(k,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.total),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Z,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Incidencias resueltas"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:a.resolved||34}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.resolved>=0?"text-green-600":"text-red-600"}`,children:[l.resolved>=0?e.jsx(P,{className:"h-3 w-3 mr-1"}):e.jsx(k,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.resolved),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(y,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tiempo medio de resolución"}),e.jsxs("h3",{className:"text-3xl font-bold mt-1",children:[a.resolutionTime||3.2," días"]}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.avgResolutionTime<=0?"text-green-600":"text-red-600"}`,children:[l.avgResolutionTime<=0?e.jsx(k,{className:"h-3 w-3 mr-1"}):e.jsx(P,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.avgResolutionTime),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(b,{className:"h-6 w-6 text-orange-600"})})]})})}),e.jsx(n,{children:e.jsx(i,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tasa de resolución"}),e.jsxs("h3",{className:"text-3xl font-bold mt-1",children:[a.total?Math.round(a.resolved/a.total*100):47,"%"]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:e.jsxs("span",{children:[a.resolved||34," de ",a.total||72," incidencias"]})})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(W,{className:"h-6 w-6 text-purple-600"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(n,{className:"overflow-hidden",children:[e.jsxs(x,{children:[e.jsx(h,{children:"Incidencias por estado"}),e.jsx(u,{children:"Distribución actual de las incidencias según su estado"})]}),e.jsx(i,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(p,{type:"pie",data:c.statusData})})})}),e.jsxs(j,{className:"flex justify-between text-sm text-gray-500 border-t",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-3 w-3 text-yellow-500 mr-1"}),e.jsxs("span",{children:["Pendientes: ",a.pending||12]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-3 w-3 text-blue-500 mr-1"}),e.jsxs("span",{children:["En proceso: ",a.inProgress||18]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsxs("span",{children:["Resueltas: ",a.resolved||34]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-3 w-3 text-red-500 mr-1"}),e.jsxs("span",{children:["Rechazadas: ",a.rejected||8]})]})]})]}),e.jsxs(n,{className:"overflow-hidden",children:[e.jsxs(x,{children:[e.jsx(h,{children:"Tendencia mensual"}),e.jsx(u,{children:"Evolución de incidencias en los últimos meses"})]}),e.jsx(i,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(p,{type:"line",data:c.monthlyData})})})}),e.jsx(j,{className:"text-sm text-gray-500 border-t",children:e.jsx("div",{className:"w-full flex justify-between",children:e.jsx("span",{children:"La tendencia muestra un aumento del 8% en la resolución de incidencias."})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(n,{className:"overflow-hidden",children:[e.jsxs(x,{children:[e.jsx(h,{children:"Incidencias por prioridad"}),e.jsx(u,{children:"Distribución de incidencias según nivel de prioridad"})]}),e.jsx(i,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(p,{type:"bar",data:c.priorityData})})})}),e.jsx(j,{className:"flex justify-between text-sm text-gray-500 border-t",children:e.jsx("div",{children:"Las incidencias de prioridad media son las más comunes (35%)."})})]}),e.jsxs(n,{className:"overflow-hidden",children:[e.jsxs(x,{children:[e.jsx(h,{children:"Incidencias por categoría"}),e.jsx(u,{children:"Distribución de incidencias por tipo de categoría"})]}),e.jsx(i,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(p,{type:"donut",data:c.categoryData})})})}),e.jsx(j,{className:"text-sm text-gray-500 border-t",children:e.jsx("div",{children:"Los daños físicos representan la mayoría de las incidencias reportadas."})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(X,{title:"⚠️ Incidencias por Parque",description:"Registro de incidencias mensuales y estado de resolución por parque",className:"h-full",children:e.jsx("div",{className:"w-full",children:c.parkData&&c.parkData.length>0?e.jsx("div",{className:"flex justify-center items-end gap-2 min-h-[320px] px-4 overflow-x-auto",children:c.parkData.sort((s,t)=>t.value-s.value).slice(0,12).map((s,t)=>{const r=Math.max(...c.parkData.map(d=>d.value)),v=r>0?s.value/r*100:0,g=d=>d===0?"#e5e7eb":d>=20?"#ef4444":d>=15?"#f59e0b":"#10b981";return e.jsxs("div",{className:"flex flex-col items-center relative",children:[e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"text-sm font-poppins font-thin text-gray-700",children:s.value}),e.jsx("div",{className:"text-xs font-poppins font-thin text-gray-500",children:"incidencias"})]}),e.jsxs("div",{className:"relative h-48 w-4 flex flex-col justify-end",children:[e.jsx("div",{className:"absolute bottom-0 w-full h-full bg-gray-200 rounded-t-3xl border border-gray-300"}),e.jsx("div",{className:"absolute bottom-0 w-full rounded-t-3xl transition-all duration-700 border border-opacity-20",style:{height:`${Math.max(v,5)}%`,backgroundColor:g(s.value),borderColor:g(s.value)}})]}),e.jsx("div",{className:"absolute bottom-24 -left-28 transform -rotate-90 origin-bottom-right w-32",children:e.jsx("div",{className:"text-xs font-poppins font-thin text-gray-700 whitespace-nowrap",children:s.name})})]},t)})}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(w,{className:"h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No hay incidencias registradas"}),e.jsx("p",{className:"text-sm",children:"Los datos de incidencias aparecerán aquí una vez que se registren en el sistema"})]})})})}),e.jsxs(n,{children:[e.jsxs(x,{className:"pb-2",children:[e.jsx(h,{children:"Incidencias recientes"}),e.jsx(u,{children:"Últimas incidencias reportadas en el sistema"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:a.mostRecentIncidents&&a.mostRecentIncidents.length>0?a.mostRecentIncidents.map((s,t)=>{var r;return e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:R(s.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:C(s.createdAt)})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(z,{className:A(s.status),children:q(s.status)}),e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),((r=s.park)==null?void 0:r.name)||`Parque ${s.parkId}`]})]})]})]},s.id)}):[{id:1,title:"Juegos infantiles dañados",status:"pending",createdAt:new Date,parkId:1,park:{name:"Parque Metropolitano"}},{id:2,title:"Falta de iluminación en sendero norte",status:"in_progress",createdAt:new Date(Date.now()-864e5),parkId:2,park:{name:"Parque Agua Azul"}},{id:3,title:"Banca rota en área de picnic",status:"resolved",createdAt:new Date(Date.now()-864e5*2),parkId:3,park:{name:"Parque González Gallo"}},{id:4,title:"Grafiti en monumento central",status:"rejected",createdAt:new Date(Date.now()-864e5*3),parkId:4,park:{name:"Parque Colomos"}}].map((s,t)=>{var r;return e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:R(s.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500",children:C(s.createdAt)})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(z,{className:A(s.status),children:q(s.status)}),e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),(r=s.park)==null?void 0:r.name]})]})]})]},t)})})}),e.jsx(j,{className:"pt-0",children:e.jsx(T,{variant:"outline",className:"w-full",onClick:()=>D("/admin/incidents"),children:"Ver todas las incidencias"})})]})]})]})})};export{ce as default};
