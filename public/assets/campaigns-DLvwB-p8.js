import{c as te,a4 as S,l as re,az as le,u as ie,ar as F,j as e,bh as ne,f,i as b,cb as L,y as ce,z as oe,B as w,bv as de,I as xe,J as me,K as ue,g as E,h as D,bj as he,ak as $,bi as je,V as C,W as z,Y as B,_ as M,$ as k,a0 as i,ay as u,q as K,n as ge,O as pe,bC as ye,C as ve,bV as Ne,aA as fe,aB as be,aI as Ce,aJ as g,aK as p,aL as y,aM as v,aN as N,a1 as we,aC as T}from"./index-BKCBrrzQ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=te("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),Ee=u.object({name:u.string().min(1,"El nombre es requerido"),client:u.string().min(1,"El cliente es requerido"),description:u.string().optional(),startDate:u.string().min(1,"La fecha de inicio es requerida"),endDate:u.string().min(1,"La fecha de fin es requerida"),budget:u.number().min(0,"El presupuesto debe ser mayor a 0"),priority:u.enum(["low","medium","high"])});function De({campaign:s,onEdit:c,onDelete:d,onToggleStatus:r}){const x=m=>{switch(m){case"active":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},t=m=>{switch(m){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},o=s.status==="active",A=new Date(s.startDate),h=new Date(s.endDate),P=new Date,l=Math.ceil((h.getTime()-P.getTime())/(1e3*60*60*24));return e.jsxs(f,{className:"hover:shadow-md transition-shadow",children:[e.jsx(E,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(D,{className:"text-lg font-semibold line-clamp-1",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Cliente: ",s.client]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{className:x(s.status),children:[s.status==="active"&&"Activa",s.status==="paused"&&"Pausada",s.status==="completed"&&"Completada",s.status==="draft"&&"Borrador"]}),e.jsxs(K,{className:t(s.priority),children:[s.priority==="high"&&"Alta",s.priority==="medium"&&"Media",s.priority==="low"&&"Baja"]})]})]})}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-3",children:[s.description&&e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:[A.toLocaleDateString()," - ",h.toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:["$",s.budget.toLocaleString()]})]})]}),s.status==="active"&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(pe,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:l>7?"text-gray-600":"text-orange-600",children:l>0?`${l} días restantes`:"Campaña vencida"})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>c(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"Editar"]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>r(s.id,o?"paused":"active"),children:o?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"w-4 h-4 mr-1"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4 mr-1"}),"Activar"]})}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>d(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(Ne,{className:"w-4 h-4"})})]})]})})]})}function Fe({campaign:s,onSubmit:c,onCancel:d}){const r=fe({resolver:be(Ee),defaultValues:{name:(s==null?void 0:s.name)||"",client:(s==null?void 0:s.client)||"",description:(s==null?void 0:s.description)||"",startDate:s!=null&&s.startDate?s.startDate.split("T")[0]:"",endDate:s!=null&&s.endDate?s.endDate.split("T")[0]:"",budget:(s==null?void 0:s.budget)||0,priority:(s==null?void 0:s.priority)||"medium"}}),x=t=>{c(t)};return e.jsx(Ce,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(x),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(g,{control:r.control,name:"name",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Nombre de la Campaña"}),e.jsx(v,{children:e.jsx(C,{placeholder:"Ej: Campaña Verde 2025",...t})}),e.jsx(N,{})]})}),e.jsx(g,{control:r.control,name:"client",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Cliente"}),e.jsx(v,{children:e.jsx(C,{placeholder:"Ej: Eco Solutions",...t})}),e.jsx(N,{})]})})]}),e.jsx(g,{control:r.control,name:"description",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Descripción"}),e.jsx(v,{children:e.jsx(we,{placeholder:"Describe los objetivos y características de la campaña...",...t})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(g,{control:r.control,name:"startDate",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Fecha de Inicio"}),e.jsx(v,{children:e.jsx(C,{type:"date",...t})}),e.jsx(N,{})]})}),e.jsx(g,{control:r.control,name:"endDate",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Fecha de Fin"}),e.jsx(v,{children:e.jsx(C,{type:"date",...t})}),e.jsx(N,{})]})}),e.jsx(g,{control:r.control,name:"budget",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Presupuesto"}),e.jsx(v,{children:e.jsx(C,{type:"number",min:"0",step:"0.01",placeholder:"0.00",...t,onChange:o=>t.onChange(parseFloat(o.target.value)||0)})}),e.jsx(N,{})]})})]}),e.jsx(g,{control:r.control,name:"priority",render:({field:t})=>e.jsxs(p,{children:[e.jsx(y,{children:"Prioridad"}),e.jsxs(z,{onValueChange:t.onChange,value:t.value,children:[e.jsx(v,{children:e.jsx(B,{children:e.jsx(M,{placeholder:"Selecciona la prioridad"})})}),e.jsxs(k,{children:[e.jsx(i,{value:"low",children:"Baja"}),e.jsx(i,{value:"medium",children:"Media"}),e.jsx(i,{value:"high",children:"Alta"})]})]}),e.jsx(N,{})]})}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(w,{type:"submit",className:"flex-1",children:s?"Actualizar Campaña":"Crear Campaña"}),e.jsx(w,{type:"button",variant:"outline",onClick:d,children:"Cancelar"})]})]})})}function Ae(){const[s,c]=S.useState(!1),[d,r]=S.useState(),[x,t]=S.useState(""),[o,A]=S.useState("all"),[h,P]=S.useState("all"),{toast:l}=re(),m=le(),{data:q,isLoading:V}=ie({queryKey:["/api/advertising-management/campaigns"],queryFn:async()=>{const a=await fetch("/api/advertising-management/campaigns");if(!a.ok)throw new Error("Error al cargar campañas");return a.json()}}),n=(q==null?void 0:q.data)||[],O=F({mutationFn:async a=>T("/api/advertising-management/campaigns",{method:"POST",body:JSON.stringify(a)}),onSuccess:()=>{l({title:"Éxito",description:"Campaña creada exitosamente."}),m.invalidateQueries({queryKey:["/api/advertising-management/campaigns"]}),c(!1)},onError:a=>{l({title:"Error",description:"No se pudo crear la campaña.",variant:"destructive"}),console.error("Error creating campaign:",a)}}),Q=F({mutationFn:async a=>T(`/api/advertising-management/campaigns/${a.id}`,{method:"PUT",body:JSON.stringify(a)}),onSuccess:()=>{l({title:"Éxito",description:"Campaña actualizada exitosamente."}),m.invalidateQueries({queryKey:["/api/advertising-management/campaigns"]}),c(!1),r(void 0)},onError:a=>{l({title:"Error",description:"No se pudo actualizar la campaña.",variant:"destructive"}),console.error("Error updating campaign:",a)}}),J=F({mutationFn:async a=>T(`/api/advertising-management/campaigns/${a}`,{method:"DELETE"}),onSuccess:()=>{l({title:"Éxito",description:"Campaña eliminada exitosamente."}),m.invalidateQueries({queryKey:["/api/advertising-management/campaigns"]})},onError:a=>{l({title:"Error",description:"No se pudo eliminar la campaña.",variant:"destructive"}),console.error("Error deleting campaign:",a)}}),H=F({mutationFn:async({id:a,status:j})=>T(`/api/advertising-management/campaigns/${a}/status`,{method:"PATCH",body:JSON.stringify({status:j})}),onSuccess:()=>{l({title:"Éxito",description:"Estado de la campaña actualizado."}),m.invalidateQueries({queryKey:["/api/advertising-management/campaigns"]})},onError:a=>{l({title:"Error",description:"No se pudo cambiar el estado de la campaña.",variant:"destructive"}),console.error("Error toggling status:",a)}}),R=a=>{d?Q.mutate({...a,id:d.id}):O.mutate(a)},U=a=>{r(a),c(!0)},G=a=>{confirm("¿Estás seguro de que deseas eliminar esta campaña?")&&J.mutate(a)},W=(a,j)=>{H.mutate({id:a,status:j})},Y=()=>{c(!1),r(void 0)},I=Array.isArray(n)?n.filter(a=>{const j=a.name.toLowerCase().includes(x.toLowerCase())||a.client.toLowerCase().includes(x.toLowerCase()),se=o==="all"||a.status===o,ae=h==="all"||a.priority===h;return j&&se&&ae}):[],_=Array.isArray(n)?n.length:0,X=Array.isArray(n)?n.filter(a=>a.status==="active").length:0,Z=Array.isArray(n)?n.reduce((a,j)=>a+j.budget,0):0,ee=Array.isArray(n)?n.filter(a=>a.status==="completed").length:0;return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{className:"bg-gray-50",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Campañas"})]}),e.jsxs(ce,{open:s,onOpenChange:c,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(w,{className:"bg-[#00a587] hover:bg-[#067f5f]",children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Nueva Campaña"]})}),e.jsxs(xe,{className:"max-w-2xl",children:[e.jsx(me,{children:e.jsx(ue,{children:d?"Editar Campaña":"Nueva Campaña"})}),e.jsx(Fe,{campaign:d,onSubmit:R,onCancel:Y})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(f,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(D,{className:"text-sm font-medium",children:"Total Campañas"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl font-bold",children:_})})]}),e.jsxs(f,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(D,{className:"text-sm font-medium",children:"Activas"}),e.jsx(he,{className:"h-4 w-4 text-green-500"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:X})})]}),e.jsxs(f,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(D,{className:"text-sm font-medium",children:"Presupuesto Total"}),e.jsx($,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(b,{children:e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",Z.toLocaleString()]})})]}),e.jsxs(f,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(D,{className:"text-sm font-medium",children:"Completadas"}),e.jsx(je,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:ee})})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(C,{placeholder:"Buscar por nombre o cliente...",value:x,onChange:a=>t(a.target.value),className:"w-full"})}),e.jsxs(z,{value:o,onValueChange:A,children:[e.jsx(B,{className:"w-full md:w-48",children:e.jsx(M,{placeholder:"Filtrar por estado"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"Todos los estados"}),e.jsx(i,{value:"active",children:"Activas"}),e.jsx(i,{value:"paused",children:"Pausadas"}),e.jsx(i,{value:"completed",children:"Completadas"}),e.jsx(i,{value:"draft",children:"Borradores"})]})]}),e.jsxs(z,{value:h,onValueChange:P,children:[e.jsx(B,{className:"w-full md:w-48",children:e.jsx(M,{placeholder:"Filtrar por prioridad"})}),e.jsxs(k,{children:[e.jsx(i,{value:"all",children:"Todas las prioridades"}),e.jsx(i,{value:"high",children:"Alta"}),e.jsx(i,{value:"medium",children:"Media"}),e.jsx(i,{value:"low",children:"Baja"})]})]})]}),V?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando campañas..."})]}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4 lg:gap-6",children:I.map(a=>e.jsx(De,{campaign:a,onEdit:U,onDelete:G,onToggleStatus:W},a.id))}),I.length===0&&!V&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay campañas"}),e.jsx("p",{className:"text-gray-500",children:x||o!=="all"||h!=="all"?"No se encontraron campañas con los filtros aplicados.":"Aún no tienes campañas publicitarias. Crea la primera para comenzar."})]})]})})}export{Ae as default};
