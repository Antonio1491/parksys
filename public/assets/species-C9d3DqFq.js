import{c as Be,a4 as c,l as ze,j as e,B as n,X as Ne,cN as Ge,b0 as Ke,ay as He,az as Qe,R as Re,u as Ce,aA as $e,ar as oe,bh as we,en as G,y as Y,z as Je,bv as We,I as Z,J as ee,K as se,N as ae,aI as Ee,Q as ce,aJ as x,aK as h,aL as u,aM as p,V as b,aN as j,W as K,Y as H,_ as Q,$ as R,a0 as l,a1 as de,f as N,g as z,h as U,H as re,i as C,b5 as me,a6 as Xe,a7 as Ye,a8 as Ze,an as es,bC as ss,bV as as,ad as rs,q as w,aX as is,aY as ts,aB as ls,aC as xe}from"./index-BKCBrrzQ.js";import{R as Se,F as Ie}from"./rabbit-CtISyuR1.js";import{B as Fe}from"./bug-p_kDnxJL.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=Be("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function De({currentImageUrl:P,onImageUploaded:$,className:k}){const[_,E]=c.useState(!1),[q,V]=c.useState(P||null),S=c.useRef(null),{toast:d}=ze(),B=async A=>{var W;const g=(W=A.target.files)==null?void 0:W[0];if(g){if(!g.type.startsWith("image/")){d({title:"Error",description:"Por favor selecciona un archivo de imagen v√°lido",variant:"destructive"});return}if(g.size>10*1024*1024){d({title:"Error",description:"La imagen no puede ser mayor a 10MB",variant:"destructive"});return}E(!0);try{const I=new FormData;I.append("image",g);const X=await fetch("/api/fauna/upload-image",{method:"POST",body:I,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!X.ok)throw new Error("Error al subir la imagen");const v=await X.json();if(v.success)V(v.data.imageUrl),$(v.data.imageUrl),d({title:"√âxito",description:"Imagen subida correctamente"});else throw new Error(v.error||"Error al subir la imagen")}catch(I){console.error("Error uploading image:",I),d({title:"Error",description:"No se pudo subir la imagen. Int√©ntalo de nuevo.",variant:"destructive"})}finally{E(!1)}}},J=()=>{V(null),$(""),S.current&&(S.current.value="")},M=()=>{var A;(A=S.current)==null||A.click()};return e.jsxs("div",{className:`space-y-4 ${k}`,children:[e.jsx("input",{ref:S,type:"file",accept:"image/*",onChange:B,className:"hidden"}),q?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden border-2 border-dashed border-gray-300",children:e.jsx("img",{src:q,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx(n,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:J,children:e.jsx(Ne,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"aspect-video bg-gray-50 rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 transition-colors cursor-pointer flex flex-col items-center justify-center",onClick:M,children:[e.jsx(Ge,{className:"h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Haz clic para seleccionar una imagen"}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-1",children:"PNG, JPG, GIF hasta 10MB"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{type:"button",variant:"outline",onClick:M,disabled:_,className:"flex-1",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),_?"Subiendo...":"Seleccionar imagen"]}),q&&e.jsxs(n,{type:"button",variant:"outline",onClick:J,disabled:_,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Quitar"]})]})]})}const ns=He.any(),ms=()=>{var ve,fe,be,ye;const[P,$]=c.useState(""),[k,_]=c.useState("all"),[E,q]=c.useState("all"),[V,S]=c.useState("grid"),[d,B]=c.useState(1),[J,M]=c.useState(!1),[A,g]=c.useState(!1),[W,I]=c.useState(!1),[X,v]=c.useState(!1),[r,he]=c.useState(null),[L,ie]=c.useState(null),[te,ue]=c.useState(!1),pe=9,{toast:m}=ze(),y=Qe();Re.useEffect(()=>{B(1)},[P,k,E]);const{data:O,isLoading:Ue}=Ce({queryKey:["/api/fauna/species",d,pe,P,k,E],queryFn:async()=>{const s=new URLSearchParams({page:d.toString(),limit:pe.toString(),search:P,category:k,conservation_status:E}),i=await fetch(`/api/fauna/species?${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!i.ok)throw new Error("Error al cargar especies");return i.json()}}),{data:F}=Ce({queryKey:["/api/fauna/stats"]}),t=$e({resolver:ls(ns),defaultValues:{commonName:"",scientificName:"",family:"",category:"aves",habitat:"",description:"",behavior:"",diet:"",reproductionPeriod:"",conservationStatus:"estable",sizeCm:"",weightGrams:"",lifespan:0,isNocturnal:!1,isMigratory:!1,isEndangered:!1,imageUrl:"",photoUrl:"",photoCaption:"",ecologicalImportance:"",threats:"",protectionMeasures:"",observationTips:"",bestObservationTime:"",commonLocations:[],iconColor:"#16a085"}}),le=oe({mutationFn:s=>xe("/api/fauna/species",{method:"POST",data:s}),onSuccess:()=>{y.invalidateQueries({queryKey:["/api/fauna/species"]}),y.invalidateQueries({queryKey:["/api/fauna/stats"]}),M(!1),t.reset(),m({title:"Especie creada exitosamente"})},onError:s=>{console.error("Error creating species:",s),m({title:"Error al crear la especie",variant:"destructive"})}}),ne=oe({mutationFn:({id:s,data:i})=>xe(`/api/fauna/species/${s}`,{method:"PUT",data:i}),onSuccess:()=>{y.invalidateQueries({queryKey:["/api/fauna/species"]}),y.invalidateQueries({queryKey:["/api/fauna/stats"]}),g(!1),t.reset(),m({title:"Especie actualizada exitosamente"})},onError:s=>{console.error("Error updating species:",s),m({title:"Error al actualizar la especie",variant:"destructive"})}}),Pe=oe({mutationFn:s=>xe(`/api/fauna/species/${s}`,{method:"DELETE"}),onSuccess:()=>{y.invalidateQueries({queryKey:["/api/fauna/species"]}),y.invalidateQueries({queryKey:["/api/fauna/stats"]}),m({title:"Especie eliminada exitosamente"})},onError:()=>{m({title:"Error al eliminar la especie",variant:"destructive"})}}),ke=(O==null?void 0:O.data)||[],f=O==null?void 0:O.pagination,Ve=s=>{console.log("Datos del formulario:",s);const i={commonName:s.commonName,scientificName:s.scientificName,family:s.family,category:s.category,conservationStatus:s.conservationStatus||"estable",isNocturnal:s.isNocturnal||!1,isMigratory:s.isMigratory||!1,isEndangered:s.isEndangered||!1,commonLocations:s.commonLocations||[],iconColor:s.iconColor||"#16a085",iconType:s.iconType||"system"};s.habitat&&(i.habitat=s.habitat),s.description&&(i.description=s.description),s.behavior&&(i.behavior=s.behavior),s.diet&&(i.diet=s.diet),s.reproductionPeriod&&(i.reproductionPeriod=s.reproductionPeriod),s.sizeCm&&(i.sizeCm=s.sizeCm),s.weightGrams&&(i.weightGrams=s.weightGrams),s.lifespan&&(i.lifespan=s.lifespan),s.imageUrl&&(i.imageUrl=s.imageUrl),s.photoUrl&&(i.photoUrl=s.photoUrl),s.photoCaption&&(i.photoCaption=s.photoCaption),s.ecologicalImportance&&(i.ecologicalImportance=s.ecologicalImportance),s.threats&&(i.threats=s.threats),s.protectionMeasures&&(i.protectionMeasures=s.protectionMeasures),s.observationTips&&(i.observationTips=s.observationTips),s.bestObservationTime&&(i.bestObservationTime=s.bestObservationTime),console.log("Datos limpiados:",i),le.mutate(i)},Me=s=>{he(s),t.reset(s),g(!0)},Ae=s=>{if(console.log("üîÑ HANDLE UPDATE EJECUT√ÅNDOSE - Datos recibidos:",s),console.log("üîç Selected species:",r),!r){console.error("‚ùå No hay especie seleccionada para actualizar"),m({title:"Error",description:"No hay especie seleccionada para actualizar",variant:"destructive"});return}if(console.log("‚úÖ Especie seleccionada encontrada, procesando actualizaci√≥n..."),!s.commonName||!s.scientificName||!s.family||!s.category){m({title:"Error",description:"Los campos Nombre Com√∫n, Nombre Cient√≠fico, Familia y Categor√≠a son requeridos",variant:"destructive"});return}const{id:i,createdAt:T,updatedAt:D,...a}=s,o={commonName:a.commonName,scientificName:a.scientificName,family:a.family,category:a.category,conservationStatus:a.conservationStatus||"estable",isNocturnal:!!a.isNocturnal,isMigratory:!!a.isMigratory,isEndangered:!!a.isEndangered,commonLocations:Array.isArray(a.commonLocations)?a.commonLocations:[],iconColor:a.iconColor||"#16a085",iconType:a.iconType||"system"};a.habitat&&(o.habitat=a.habitat),a.description&&(o.description=a.description),a.behavior&&(o.behavior=a.behavior),a.diet&&(o.diet=a.diet),a.reproductionPeriod&&(o.reproductionPeriod=a.reproductionPeriod),a.sizeCm&&(o.sizeCm=a.sizeCm),a.weightGrams&&(o.weightGrams=a.weightGrams),a.lifespan&&(o.lifespan=Number(a.lifespan)||0),a.imageUrl&&(o.imageUrl=a.imageUrl),a.photoUrl&&(o.photoUrl=a.photoUrl),a.photoCaption&&(o.photoCaption=a.photoCaption),a.ecologicalImportance&&(o.ecologicalImportance=a.ecologicalImportance),a.threats&&(o.threats=a.threats),a.protectionMeasures&&(o.protectionMeasures=a.protectionMeasures),a.observationTips&&(o.observationTips=a.observationTips),a.bestObservationTime&&(o.bestObservationTime=a.bestObservationTime),console.log("üìã Datos de actualizaci√≥n limpiados:",o),console.log("üöÄ Ejecutando mutaci√≥n con ID:",r.id),ne.mutate({id:r.id,data:o})},Le=s=>{confirm("¬øEst√°s seguro de que quieres eliminar esta especie?")&&Pe.mutate(s)},Oe=async()=>{if(!L){m({title:"Error",description:"Por favor selecciona un archivo CSV",variant:"destructive"});return}ue(!0);try{const s=new FormData;s.append("csvFile",L);const T=await(await fetch("/api/fauna/import-csv",{method:"POST",body:s,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();T.success?(m({title:"Importaci√≥n exitosa",description:T.message}),y.invalidateQueries({queryKey:["/api/fauna/species"]}),y.invalidateQueries({queryKey:["/api/fauna/stats"]}),v(!1),ie(null)):m({title:"Error en importaci√≥n",description:T.error,variant:"destructive"})}catch(s){console.error("Error importing CSV:",s),m({title:"Error",description:"Error al importar el archivo CSV",variant:"destructive"})}finally{ue(!1)}},_e=async()=>{try{const s=await fetch("/api/fauna/csv-template",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const i=await s.blob(),T=window.URL.createObjectURL(i),D=document.createElement("a");D.style.display="none",D.href=T,D.download="plantilla_fauna_especies.csv",document.body.appendChild(D),D.click(),window.URL.revokeObjectURL(T),document.body.removeChild(D),m({title:"Plantilla descargada",description:"La plantilla CSV se ha descargado correctamente"})}else throw new Error("Error al descargar plantilla")}catch(s){console.error("Error downloading template:",s),m({title:"Error",description:"Error al descargar la plantilla CSV",variant:"destructive"})}},qe=s=>{he(s),I(!0)},je=s=>{switch(s){case"aves":return e.jsx(re,{className:"h-5 w-5 text-blue-600"});case"mamiferos":return e.jsx(Se,{className:"h-5 w-5 text-green-600"});case"insectos":return e.jsx(Fe,{className:"h-5 w-5 text-yellow-600"});case"vida_acuatica":return e.jsx(Ie,{className:"h-5 w-5 text-teal-600"});default:return e.jsx(re,{className:"h-5 w-5 text-gray-600"})}},ge=s=>{switch(s){case"estable":return"bg-green-100 text-green-800";case"vulnerable":return"bg-yellow-100 text-yellow-800";case"en_peligro":return"bg-orange-100 text-orange-800";case"en_peligro_critico":return"bg-red-100 text-red-800";case"extinto_local":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return Ue?e.jsx(we,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):e.jsx(we,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesti√≥n de Fauna"}),e.jsx("p",{className:"text-gray-600",children:"Administra el cat√°logo de especies de fauna urbana"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>v(!0),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Importar"]}),e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Exportar"]}),e.jsxs(Y,{open:J,onOpenChange:M,children:[e.jsx(Je,{asChild:!0,children:e.jsxs(n,{children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Nueva Especie"]})}),e.jsxs(Z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Crear Nueva Especie"}),e.jsx(ae,{children:"Agrega una nueva especie al cat√°logo de fauna"})]}),e.jsx(Ee,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(s=>{console.log("SUBMIT EJECUTADO",s),Ve(s)}),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{children:"Fotograf√≠a de la Especie"}),e.jsx(De,{currentImageUrl:t.watch("photoUrl"),onImageUploaded:s=>t.setValue("photoUrl",s)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:t.control,name:"commonName",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Nombre Com√∫n"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Nombre com√∫n de la especie",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"scientificName",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Nombre Cient√≠fico"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Nombre cient√≠fico",...s})}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:t.control,name:"family",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Familia"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Familia taxon√≥mica",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"category",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Categor√≠a"}),e.jsxs(K,{value:s.value,onValueChange:s.onChange,children:[e.jsx(p,{children:e.jsx(H,{children:e.jsx(Q,{placeholder:"Seleccionar categor√≠a"})})}),e.jsxs(R,{children:[e.jsx(l,{value:"aves",children:"Aves"}),e.jsx(l,{value:"mamiferos",children:"Mam√≠feros"}),e.jsx(l,{value:"insectos",children:"Insectos"}),e.jsx(l,{value:"vida_acuatica",children:"Vida Acu√°tica"})]})]}),e.jsx(j,{})]})})]}),e.jsx(x,{control:t.control,name:"habitat",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"H√°bitat"}),e.jsx(p,{children:e.jsx(b,{placeholder:"H√°bitat natural",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"description",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Descripci√≥n"}),e.jsx(p,{children:e.jsx(de,{placeholder:"Descripci√≥n de la especie",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"behavior",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Comportamiento"}),e.jsx(p,{children:e.jsx(de,{placeholder:"Comportamiento de la especie",...s})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>M(!1),children:"Cancelar"}),e.jsx(n,{type:"submit",disabled:le.isPending,onClick:()=>console.log("BOT√ìN CLICKEADO",t.formState.errors),children:le.isPending?"Creando...":"Crear Especie"})]})]})})]})]})]})]}),F&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Total Especies"}),e.jsx(re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:F.data.total})})]}),e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Aves"}),e.jsx(re,{className:"h-4 w-4 text-blue-600"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:((ve=F.data.byCategory.find(s=>s.category==="aves"))==null?void 0:ve.count)||0})})]}),e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Mam√≠feros"}),e.jsx(Se,{className:"h-4 w-4 text-green-600"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:((fe=F.data.byCategory.find(s=>s.category==="mamiferos"))==null?void 0:fe.count)||0})})]}),e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Vida Acu√°tica"}),e.jsx(Ie,{className:"h-4 w-4 text-teal-600"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:((be=F.data.byCategory.find(s=>s.category==="vida_acuatica"))==null?void 0:be.count)||0})})]}),e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"Insectos"}),e.jsx(Fe,{className:"h-4 w-4 text-yellow-600"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:((ye=F.data.byCategory.find(s=>s.category==="insectos"))==null?void 0:ye.count)||0})})]}),e.jsxs(N,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(U,{className:"text-sm font-medium",children:"En Peligro"}),e.jsx(me,{className:"h-4 w-4 text-red-600"})]}),e.jsx(C,{children:e.jsx("div",{className:"text-2xl font-bold",children:F.data.endangered})})]})]}),e.jsx(N,{children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(b,{placeholder:"Buscar especies...",value:P,onChange:s=>$(s.target.value),className:"pl-10"})]}),e.jsxs(K,{value:k,onValueChange:_,children:[e.jsx(H,{className:"w-[180px]",children:e.jsx(Q,{placeholder:"Categor√≠a"})}),e.jsxs(R,{children:[e.jsx(l,{value:"all",children:"Todas las categor√≠as"}),e.jsx(l,{value:"aves",children:"Aves"}),e.jsx(l,{value:"mamiferos",children:"Mam√≠feros"}),e.jsx(l,{value:"insectos",children:"Insectos"}),e.jsx(l,{value:"vida_acuatica",children:"Vida Acu√°tica"})]})]}),e.jsxs(K,{value:E,onValueChange:q,children:[e.jsx(H,{className:"w-[200px]",children:e.jsx(Q,{placeholder:"Estado Conservaci√≥n"})}),e.jsxs(R,{children:[e.jsx(l,{value:"all",children:"Todos los estados"}),e.jsx(l,{value:"estable",children:"Estable"}),e.jsx(l,{value:"vulnerable",children:"Vulnerable"}),e.jsx(l,{value:"en_peligro",children:"En Peligro"}),e.jsx(l,{value:"en_peligro_critico",children:"Peligro Cr√≠tico"}),e.jsx(l,{value:"extinto_local",children:"Extinto Local"})]})]}),e.jsxs("div",{className:"flex border rounded-lg",children:[e.jsx(n,{variant:V==="grid"?"default":"ghost",size:"sm",onClick:()=>S("grid"),className:"rounded-r-none",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx(n,{variant:V==="list"?"default":"ghost",size:"sm",onClick:()=>S("list"),className:"rounded-l-none",children:e.jsx(Ze,{className:"h-4 w-4"})})]})]})})}),e.jsx("div",{className:V==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:ke.map(s=>e.jsxs(N,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(z,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[je(s.category),e.jsx(U,{className:"text-lg",children:s.commonName})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>qe(s),children:e.jsx(es,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>Me(s),children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>Le(s.id),children:e.jsx(as,{className:"h-4 w-4"})})]})]}),e.jsx(rs,{className:"italic",children:s.scientificName})]}),e.jsx(C,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"secondary",className:"capitalize",children:s.category.replace("_"," ")}),e.jsx(w,{className:ge(s.conservationStatus),children:s.conservationStatus.replace("_"," ")})]}),s.isEndangered&&e.jsxs(w,{variant:"destructive",className:"text-xs",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"En Peligro"]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description||"Sin descripci√≥n disponible"})]})})]},s.id))}),f&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Mostrando ",(f.page-1)*f.limit+1," a"," ",Math.min(f.page*f.limit,f.total)," de"," ",f.total," especies"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>{console.log(`üîÑ Navegando a p√°gina anterior desde ${d}`),B(d-1)},disabled:d<=1,children:[e.jsx(is,{className:"h-4 w-4"}),"Anterior"]}),e.jsxs("span",{className:"px-3 py-1 bg-primary text-primary-foreground rounded text-sm",children:[d," de ",f.totalPages]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>{console.log(`üîÑ Navegando a p√°gina siguiente desde ${d}`),B(d+1)},disabled:d>=f.totalPages,children:["Siguiente",e.jsx(ts,{className:"h-4 w-4"})]})]})]}),e.jsx(Y,{open:A,onOpenChange:g,children:e.jsxs(Z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Editar Especie"}),e.jsx(ae,{children:"Modifica los datos de la especie seleccionada"})]}),e.jsx(Ee,{...t,children:e.jsxs("form",{onSubmit:s=>{console.log("üîÑ Form onSubmit ejecut√°ndose"),console.log("üìã Form errors:",t.formState.errors),console.log("üìã Form values:",t.getValues());try{t.handleSubmit(Ae)(s)}catch(i){console.error("‚ùå Error en handleSubmit:",i)}},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{children:"Fotograf√≠a de la Especie"}),e.jsx(De,{currentImageUrl:t.watch("photoUrl"),onImageUploaded:s=>t.setValue("photoUrl",s)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:t.control,name:"commonName",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Nombre Com√∫n"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Nombre com√∫n de la especie",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"scientificName",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Nombre Cient√≠fico"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Nombre cient√≠fico",...s})}),e.jsx(j,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{control:t.control,name:"family",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Familia"}),e.jsx(p,{children:e.jsx(b,{placeholder:"Familia taxon√≥mica",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"category",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Categor√≠a"}),e.jsxs(K,{value:s.value,onValueChange:s.onChange,children:[e.jsx(p,{children:e.jsx(H,{children:e.jsx(Q,{placeholder:"Seleccionar categor√≠a"})})}),e.jsxs(R,{children:[e.jsx(l,{value:"aves",children:"Aves"}),e.jsx(l,{value:"mamiferos",children:"Mam√≠feros"}),e.jsx(l,{value:"insectos",children:"Insectos"}),e.jsx(l,{value:"vida_acuatica",children:"Vida Acu√°tica"})]})]}),e.jsx(j,{})]})})]}),e.jsx(x,{control:t.control,name:"habitat",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"H√°bitat"}),e.jsx(p,{children:e.jsx(b,{placeholder:"H√°bitat natural",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"description",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Descripci√≥n"}),e.jsx(p,{children:e.jsx(de,{placeholder:"Descripci√≥n de la especie",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"conservationStatus",render:({field:s})=>e.jsxs(h,{children:[e.jsx(u,{children:"Estado de Conservaci√≥n"}),e.jsxs(K,{value:s.value,onValueChange:s.onChange,children:[e.jsx(p,{children:e.jsx(H,{children:e.jsx(Q,{placeholder:"Seleccionar estado"})})}),e.jsxs(R,{children:[e.jsx(l,{value:"estable",children:"Estable"}),e.jsx(l,{value:"vulnerable",children:"Vulnerable"}),e.jsx(l,{value:"en_peligro",children:"En Peligro"}),e.jsx(l,{value:"en_peligro_critico",children:"Peligro Cr√≠tico"}),e.jsx(l,{value:"extinto_local",children:"Extinto Local"})]})]}),e.jsx(j,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancelar"}),e.jsx(n,{type:"submit",disabled:ne.isPending,children:ne.isPending?"Actualizando...":"Actualizar Especie"})]})]})})]})}),e.jsx(Y,{open:X,onOpenChange:v,children:e.jsxs(Z,{className:"max-w-2xl",children:[e.jsxs(ee,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Importar Especies desde CSV"]}),e.jsx(ae,{children:"Sube un archivo CSV con la informaci√≥n de las especies de fauna para importaci√≥n masiva"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"üìã Descargar Plantilla"}),e.jsx("p",{className:"text-sm text-blue-800 mb-3",children:"Descarga la plantilla CSV con el formato correcto y ejemplos de datos."}),e.jsxs(n,{variant:"outline",size:"sm",onClick:_e,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Descargar Plantilla CSV"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ce,{htmlFor:"csv-file",children:"Seleccionar archivo CSV"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{id:"csv-file",type:"file",accept:".csv",onChange:s=>{var i;return ie(((i=s.target.files)==null?void 0:i[0])||null)},className:"hidden"}),L?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-green-600",children:[e.jsx(G,{className:"h-8 w-8 mr-2"}),e.jsx("span",{className:"font-medium",children:L.name})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Tama√±o: ",(L.size/1024).toFixed(2)," KB"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{var s;return(s=document.getElementById("csv-file"))==null?void 0:s.click()},children:"Cambiar archivo"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center text-gray-400",children:[e.jsx(G,{className:"h-8 w-8 mr-2"}),e.jsx("span",{children:"Arrastra tu archivo CSV aqu√≠"})]}),e.jsx(n,{variant:"outline",onClick:()=>{var s;return(s=document.getElementById("csv-file"))==null?void 0:s.click()},children:"Seleccionar archivo"})]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"‚ö†Ô∏è Informaci√≥n Importante"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ El archivo debe estar en formato CSV con codificaci√≥n UTF-8"}),e.jsx("li",{children:"‚Ä¢ Los campos obligatorios son: nombre_com√∫n y nombre_cient√≠fico"}),e.jsx("li",{children:"‚Ä¢ Las categor√≠as v√°lidas son: aves, mamiferos, insectos, vida_acuatica"}),e.jsx("li",{children:"‚Ä¢ Los valores booleanos se escriben como: true/false, s√≠/no, 1/0"}),e.jsx("li",{children:"‚Ä¢ Si hay errores, se mostrar√° un reporte detallado"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>{v(!1),ie(null)},disabled:te,children:"Cancelar"}),e.jsx(n,{onClick:Oe,disabled:!L||te,children:te?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Importando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Importar Especies"]})})]})]})]})}),e.jsx(Y,{open:W,onOpenChange:I,children:e.jsxs(Z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ee,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[r&&je(r.category),r==null?void 0:r.commonName]}),e.jsx(ae,{className:"italic",children:r==null?void 0:r.scientificName})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[r.photoUrl&&e.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:r.photoUrl,alt:r.commonName,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"secondary",className:"capitalize",children:r.category.replace("_"," ")}),e.jsx(w,{className:ge(r.conservationStatus),children:r.conservationStatus.replace("_"," ")}),r.isEndangered&&e.jsxs(w,{variant:"destructive",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"En Peligro"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Informaci√≥n B√°sica"}),e.jsxs("div",{className:"mt-2 space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Familia:"})," ",r.family]}),e.jsxs("div",{children:[e.jsx("strong",{children:"H√°bitat:"})," ",r.habitat||"No especificado"]}),r.sizeCm&&e.jsxs("div",{children:[e.jsx("strong",{children:"Tama√±o:"})," ",r.sizeCm," cm"]}),r.weightGrams&&e.jsxs("div",{children:[e.jsx("strong",{children:"Peso:"})," ",r.weightGrams," gramos"]}),r.lifespan&&r.lifespan>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Esperanza de vida:"})," ",r.lifespan," a√±os"]})]})]}),r.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Descripci√≥n"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r.description})]}),r.behavior&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Comportamiento"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r.behavior})]}),r.diet&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Dieta"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r.diet})]}),r.ecologicalImportance&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Importancia Ecol√≥gica"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r.ecologicalImportance})]}),r.threats&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Amenazas"}),e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.threats})]}),r.observationTips&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Consejos de Observaci√≥n"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r.observationTips})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4",children:[r.isNocturnal&&e.jsx(w,{variant:"outline",children:"Nocturno"}),r.isMigratory&&e.jsx(w,{variant:"outline",children:"Migratorio"})]})]})]})]})})]})})};export{ms as default};
