import{c as Re,ay as P,l as _e,az as Ge,a4 as o,aA as Je,u as me,ar as he,j as e,bh as He,cY as Ue,ao as z,B as l,bv as K,bk as We,bl as Xe,bm as ue,a9 as Se,bn as ge,cZ as $,aY as v,f as h,i as p,q as j,bV as T,a6 as ke,V as Ie,X as Ee,W as B,Y as Q,_ as O,$ as R,a0 as f,dQ as Pe,dR as Ye,a8 as Ze,aX as Me,b2 as Te,y as es,I as ss,J as as,K as ls,N as rs,aI as ts,aJ as _,aK as G,aL as J,aM as H,aN as U,a1 as is,bE as ns,a$ as cs,cr as ds,dS as os,bF as xs,o as ms,dT as hs,ce as us,aB as gs,aC as je}from"./index-BKCBrrzQ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=Re("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),js=P.object({name:P.string().min(2,"El nombre debe tener al menos 2 caracteres"),description:P.string().optional(),icon:P.string().min(1,"Selecciona un Ã­cono"),color:P.string().min(4,"Selecciona un color"),parentId:P.number().nullable().optional()}),le=[{value:"building2",label:"Infraestructura",icon:cs},{value:"wrench",label:"Herramientas",icon:ds},{value:"car",label:"VehÃ­culos",icon:os},{value:"lightbulb",label:"IluminaciÃ³n",icon:xs},{value:"camera",label:"Seguridad",icon:ms},{value:"wifi",label:"TecnologÃ­a",icon:hs},{value:"tag",label:"General",icon:z},{value:"settings",label:"Equipos",icon:us},{value:"treePine",label:"JardinerÃ­a",icon:Te},{value:"folderOpen",label:"CategorÃ­a",icon:Pe}],vs=[{value:"#3B82F6",label:"Azul",bg:"bg-blue-500"},{value:"#10B981",label:"Verde",bg:"bg-emerald-500"},{value:"#F59E0B",label:"Naranja",bg:"bg-amber-500"},{value:"#6366F1",label:"Ãndigo",bg:"bg-indigo-500"},{value:"#EC4899",label:"Rosa",bg:"bg-pink-500"},{value:"#8B5CF6",label:"PÃºrpura",bg:"bg-violet-500"},{value:"#EF4444",label:"Rojo",bg:"bg-red-500"},{value:"#14B8A6",label:"Teal",bg:"bg-teal-500"},{value:"#067f5f",label:"Verde Parques",bg:"bg-green-700"},{value:"#00a587",label:"Verde Principal",bg:"bg-green-600"}],bs=()=>{const{toast:w}=_e(),u=Ge(),[q,W]=o.useState(!1),[Le,X]=o.useState(!1),[ve,re]=o.useState(null),[Y,qe]=o.useState(null),[Fe,Ae]=o.useState("list"),[te,ie]=o.useState(new Set),[c,De]=o.useState(!0),[x,Z]=o.useState(1),[C,ne]=o.useState(""),[S,pe]=o.useState("all"),[F,be]=o.useState("all"),[ee,Ne]=o.useState("compact"),[b,A]=o.useState(1),d=10,g=Je({resolver:gs(js),defaultValues:{name:"",description:"",icon:"tag",color:"#3B82F6",parentId:null}}),{data:n=[],isLoading:Ve}=me({queryKey:["/api/asset-categories"]}),{data:D=[]}=me({queryKey:["/api/asset-categories/parents"]}),{data:m=[]}=me({queryKey:["/api/asset-categories/tree/structure"]}),Ke=o.useMemo(()=>Array.from(new Set(n.map(a=>a.icon))).sort(),[n]),N=o.useMemo(()=>{let s=n;return C&&(s=s.filter(a=>{var t,r;return a.name.toLowerCase().includes(C.toLowerCase())||((t=a.description)==null?void 0:t.toLowerCase().includes(C.toLowerCase()))||((r=a.parentName)==null?void 0:r.toLowerCase().includes(C.toLowerCase()))})),S!=="all"&&(s=s.filter(a=>S==="principal"?a.parentId===null:S==="subcategoria"?a.parentId!==null:!0)),F!=="all"&&(s=s.filter(a=>a.icon===F)),s},[n,C,S,F]),k=Math.ceil(N.length/d),se=(b-1)*d,ce=se+d,de=N.slice(se,ce),ae=()=>{A(1)},oe=he({mutationFn:async s=>await(await je("/api/asset-categories",{method:"POST",data:s})).json(),onSuccess:s=>{console.log("CategorÃ­a creada exitosamente:",s),u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),setTimeout(()=>{u.invalidateQueries({queryKey:["/api/asset-categories"]}),u.invalidateQueries({queryKey:["/api/asset-categories/parents"]}),u.invalidateQueries({queryKey:["/api/asset-categories/tree/structure"]})},100),W(!1),g.reset(),w({title:"âœ… CategorÃ­a creada",description:"La categorÃ­a se ha creado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al crear la categorÃ­a",variant:"destructive"})}}),xe=he({mutationFn:async({id:s,data:a})=>await(await je(`/api/asset-categories/${s}`,{method:"PUT",data:a})).json(),onSuccess:()=>{u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),X(!1),re(null),g.reset(),w({title:"âœ… CategorÃ­a actualizada",description:"La categorÃ­a se ha actualizado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al actualizar la categorÃ­a",variant:"destructive"})}}),$e=he({mutationFn:async s=>await(await je(`/api/asset-categories/${s}`,{method:"DELETE"})).json(),onSuccess:()=>{u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),w({title:"âœ… CategorÃ­a eliminada",description:"La categorÃ­a se ha eliminado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al eliminar la categorÃ­a",variant:"destructive"})}}),Be=s=>{const a={...s,parentId:Y||s.parentId||null};oe.mutate(a)},I=s=>{re(s),g.reset({name:s.name,description:s.description||"",icon:s.icon,color:s.color,parentId:s.parentId}),X(!0)},Qe=s=>{ve&&xe.mutate({id:ve.id,data:s})},E=s=>{window.confirm(`Â¿EstÃ¡s seguro de eliminar la categorÃ­a "${s.name}"?`)&&$e.mutate(s.id)},V=(s=null)=>{qe(s),g.reset({name:"",description:"",icon:"tag",color:"#3B82F6",parentId:s}),W(!0)},fe=s=>{const a=new Set(te);a.has(s)?a.delete(s):a.add(s),ie(a)},Ce=()=>{const s=D.filter(a=>n.filter(r=>r.parentId===a.id).length>0).map(a=>a.id);ie(new Set(s))},ye=()=>{ie(new Set)},y=(s,a=20)=>{var r;const t=((r=le.find(i=>i.value===s))==null?void 0:r.icon)||z;return e.jsx(t,{size:a})},ze=({category:s,isSubcategory:a=!1})=>e.jsx(h,{className:`transition-all hover:shadow-md ${a?"ml-6 border-l-4":""}`,style:a?{borderLeftColor:s.color}:{},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[s.parentName&&e.jsxs(j,{variant:"outline",className:"text-xs",children:["ðŸ“ ",s.parentName]}),s.hasChildren&&e.jsxs(j,{variant:"secondary",className:"text-xs",children:[s.childrenCount," subcategorÃ­a(s)"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!a&&e.jsx(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),children:e.jsx(K,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>E(s),children:e.jsx(T,{size:16})})]})]})})}),we=({category:s})=>{const a=n.filter(i=>i.parentId===s.id),t=a.length>0,r=te.has(s.id);return s.parentId?e.jsx(h,{className:"transition-all hover:shadow-md ml-8 border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,20)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900",children:s.name}),e.jsx(j,{variant:"secondary",className:"text-xs",children:"SubcategorÃ­a"})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]})]}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-gray-500 ml-11",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{size:12}),e.jsxs("span",{children:["ID: ",s.id]})]})})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-green-600 hover:bg-green-50 h-8 w-8 p-0",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-red-600 hover:bg-red-50 h-8 w-8 p-0",children:e.jsx(T,{size:14})})]})]})})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),className:"p-1 h-8 w-8 hover:bg-gray-100 self-start",children:r?e.jsx($,{size:16,className:"text-blue-600"}):e.jsx(v,{size:16,className:"text-gray-600"})}),!t&&e.jsx("div",{className:"w-8"}),e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx(j,{variant:"default",className:"text-xs",children:"Principal"}),t&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[a.length," subcategorÃ­a(s)"]})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500 ml-12",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:14}),e.jsxs("span",{children:["ID: ",s.id]})]}),t&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:14}),e.jsxs("span",{children:[a.length," subcategorÃ­as"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(K,{size:16,className:"mr-1"}),"SubcategorÃ­a"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:16})})]})]})})}),t&&r&&e.jsx("div",{className:"space-y-2 border-l-2 border-gray-200 pl-4 ml-4",children:a.map(i=>e.jsx(we,{category:i},i.id))})]})};return Ve?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando categorÃ­as..."})]})}):e.jsx(He,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ue,{title:"CategorÃ­as de Activos",subtitle:"Gestiona las categorÃ­as jerÃ¡rquicas para organizar tus activos",icon:e.jsx(z,{}),actions:[e.jsxs(l,{onClick:()=>V(),variant:"primary",children:[e.jsx(K,{className:"mr-2",size:16}),"Nueva CategorÃ­a"]},"nueva-categoria")]}),e.jsxs(We,{value:Fe,onValueChange:Ae,className:"w-full",children:[e.jsxs(Xe,{className:"grid w-full grid-cols-3",children:[e.jsx(ue,{value:"list",children:e.jsxs("div",{className:"flex items-center gap-2",children:["Lista Completa",e.jsx(Se,{size:14,className:"text-blue-500"})]})}),e.jsx(ue,{value:"hierarchy",children:"Vista JerÃ¡rquica"}),e.jsx(ue,{value:"tree",children:"Estructura de Ãrbol"})]}),e.jsxs(ge,{value:"hierarchy",className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:Ce,className:"text-blue-600 hover:bg-blue-50",children:[e.jsx($,{size:16,className:"mr-2"}),"Expandir Todo"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:ye,className:"text-gray-600 hover:bg-gray-50",children:[e.jsx(v,{size:16,className:"mr-2"}),"Contraer Todo"]})]}),D.map(s=>{const a=n.filter(i=>i.parentId===s.id),t=a.length>0,r=te.has(s.id);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),className:"p-1 h-8 w-8 hover:bg-gray-100",children:r?e.jsx($,{size:16,className:"text-blue-600"}):e.jsx(v,{size:16,className:"text-gray-600"})}),!t&&e.jsx("div",{className:"w-8"}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",className:"text-xs",children:"Principal"}),t&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[a.length," subcategorÃ­a(s)"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(K,{size:16,className:"mr-1"}),"SubcategorÃ­a"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:16})})]})]})})}),t&&r&&e.jsx("div",{className:"ml-8 space-y-2 border-l-2 border-gray-200 pl-4",children:a.map(i=>e.jsx(h,{className:"transition-all hover:shadow-sm border-l-4",style:{borderLeftColor:i.color},children:e.jsx(p,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 rounded-lg",style:{backgroundColor:`${i.color}20`,color:i.color},children:y(i.icon,20)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-base",children:i.name}),i.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description}),e.jsx(j,{variant:"outline",className:"text-xs mt-1",children:"SubcategorÃ­a"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(i),className:"text-green-600 hover:bg-green-50 h-8 w-8 p-0",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(i),className:"text-red-600 hover:bg-red-50 h-8 w-8 p-0",children:e.jsx(T,{size:14})})]})]})})},i.id))})]},s.id)}),n.filter(s=>!s.parentId&&!D.find(a=>a.id===s.id)).map(s=>e.jsx(ze,{category:s},s.id))]}),e.jsxs(ge,{value:"list",className:"space-y-6",children:[e.jsxs(h,{className:"p-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(Ie,{placeholder:"Buscar por nombre, descripciÃ³n o categorÃ­a padre...",value:C,onChange:s=>{ne(s.target.value),ae()},className:"pl-10"}),C&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{ne(""),ae()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:e.jsx(Ee,{size:14})})]})}),e.jsx("div",{children:e.jsxs(B,{value:S,onValueChange:s=>{pe(s),ae()},children:[e.jsx(Q,{children:e.jsx(O,{})}),e.jsxs(R,{children:[e.jsx(f,{value:"all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{size:16}),"Todos los tipos"]})}),e.jsx(f,{value:"principal",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{size:16}),"Principales"]})}),e.jsx(f,{value:"subcategoria",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:16}),"SubcategorÃ­as"]})})]})]})}),e.jsx("div",{children:e.jsxs(B,{value:F,onValueChange:s=>{be(s),ae()},children:[e.jsx(Q,{children:e.jsx(O,{})}),e.jsxs(R,{children:[e.jsx(f,{value:"all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:16}),"Todos los iconos"]})}),Ke.map(s=>{var t,r;const a=((t=le.find(i=>i.value===s))==null?void 0:t.icon)||z;return e.jsx(f,{value:s,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{size:16}),((r=le.find(i=>i.value===s))==null?void 0:r.label)||s]})},s)})]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",de.length," de ",N.length," categorÃ­as",N.length!==n.length&&` (${n.length} en total)`]}),(C||S!=="all"||F!=="all")&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{ne(""),pe("all"),be("all"),A(1)},className:"text-gray-600",children:[e.jsx(Ee,{size:14,className:"mr-1"}),"Limpiar filtros"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",se+1,"-",Math.min(ce,N.length)," de ",N.length," categorÃ­as"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[ee==="extended"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:Ce,className:"text-blue-600 hover:bg-blue-50",children:[e.jsx($,{size:14,className:"mr-1"}),"Expandir Todo"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:ye,className:"text-gray-600 hover:bg-gray-50",children:[e.jsx(v,{size:14,className:"mr-1"}),"Contraer Todo"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vista:"}),e.jsxs("div",{className:"flex border rounded-md",children:[e.jsxs(l,{variant:ee==="compact"?"default":"ghost",size:"sm",onClick:()=>Ne("compact"),className:"rounded-r-none border-r-0",children:[e.jsx(Ye,{size:16,className:"mr-1"}),"Compacta"]}),e.jsxs(l,{variant:ee==="extended"?"default":"ghost",size:"sm",onClick:()=>Ne("extended"),className:"rounded-l-none",children:[e.jsx(Ze,{size:16,className:"mr-1"}),"Extendida"]})]})]})]})]}),ee==="compact"?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:de.map(s=>e.jsx(ze,{category:s},s.id))}):e.jsx("div",{className:"space-y-4",children:de.filter(s=>!s.parentId).map(s=>e.jsx(we,{category:s},s.id))}),N.length===0&&e.jsx(h,{className:"p-8 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(ke,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No se encontraron categorÃ­as"}),e.jsx("p",{children:"Prueba ajustando los filtros o tÃ©rminos de bÃºsqueda"})]})}),k>1&&e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["PÃ¡gina ",b," de ",k," - Mostrando ",se+1,"-",Math.min(ce,N.length)," de ",N.length," categorÃ­as"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>A(b-1),disabled:b===1,className:"flex items-center gap-1",children:[e.jsx(Me,{size:16}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,k)},(s,a)=>{const t=Math.max(1,Math.min(k-4,b-2))+a;return t>k?null:e.jsx(l,{variant:b===t?"default":"outline",size:"sm",onClick:()=>A(t),className:b===t?"bg-green-600 hover:bg-green-700":"",children:t},t)})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>A(b+1),disabled:b===k,className:"flex items-center gap-1",children:["Siguiente",e.jsx(v,{size:16})]})]})]})})]}),e.jsxs(ge,{value:"tree",className:"space-y-2",children:[e.jsx("div",{className:"mb-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Estructura de Ãrbol de CategorÃ­as"}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{De(!c),Z(1)},className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx($,{size:16}),"Contraer Todo"]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:16}),"Expandir Todo"]})})]})}),e.jsx("div",{className:"mb-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Mostrando: ",Math.min(d,m.filter(s=>c||s.level===0).length-(x-1)*d)," de ",m.filter(s=>c||s.level===0).length," categorÃ­as"]}),e.jsxs("span",{children:["Estado: ",c?"EXPANDIDO":"CONTRAÃDO"," | PÃ¡gina ",x," de ",Math.ceil(m.filter(s=>c||s.level===0).length/d)]})]})}),m.filter(s=>c||s.level===0).slice((x-1)*d,x*d).map(s=>{var a,t;return e.jsx(h,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{style:{marginLeft:`${(s.level||0)*32}px`},className:"flex items-center gap-3",children:[s.level&&s.level>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:s.level},(r,i)=>e.jsx("div",{className:"w-1 h-4 bg-gray-300 rounded"},i)),e.jsx(v,{size:16,className:"text-gray-500"})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,20)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-lg",children:s.name}),e.jsx(j,{variant:s.level===0?"default":"secondary",className:"text-xs",children:s.level===0?"Principal":`Nivel ${s.level}`}),s.pathNames&&e.jsxs(j,{variant:"outline",className:"text-xs",children:["ðŸ“ ",s.pathNames]})]}),((a=n.find(r=>r.id===s.id))==null?void 0:a.description)&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(t=n.find(r=>r.id===s.id))==null?void 0:t.description})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[s.level===0&&e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(K,{size:14,className:"mr-1"}),"Sub"]}),s.level===0&&!c&&n.filter(r=>r.parentId===s.id).length>0&&e.jsxs(j,{variant:"outline",className:"text-xs bg-yellow-50 border-yellow-300 text-yellow-700",children:["+",n.filter(r=>r.parentId===s.id).length," sub"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(n.find(r=>r.id===s.id)),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(n.find(r=>r.id===s.id)),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:14})})]})]})})},s.id)}),m.filter(s=>c||s.level===0).length>d&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["PÃ¡gina ",x," de ",Math.ceil(m.filter(s=>c||s.level===0).length/d)," - Mostrando ",(x-1)*d+1,"-",Math.min(x*d,m.filter(s=>c||s.level===0).length)," de ",m.filter(s=>c||s.level===0).length," categorÃ­as"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>Z(Math.max(1,x-1)),disabled:x===1,className:"flex items-center gap-1",children:[e.jsx(Me,{size:16}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Math.ceil(m.filter(s=>c||s.level===0).length/d))},(s,a)=>{const t=Math.ceil(m.filter(Oe=>c||Oe.level===0).length/d);let r=Math.max(1,x-2),i=Math.min(t,r+4);i-r<4&&(r=Math.max(1,i-4));const M=r+a;return M<=t?e.jsx(l,{variant:M===x?"default":"outline",size:"sm",onClick:()=>Z(M),className:M===x?"bg-green-600 hover:bg-green-700":"",children:M},M):null})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>Z(Math.min(Math.ceil(m.filter(s=>c||s.level===0).length/d),x+1)),disabled:x>=Math.ceil(m.filter(s=>c||s.level===0).length/d),className:"flex items-center gap-1",children:["Siguiente",e.jsx(v,{size:16})]})]})]}),m.length===0&&e.jsx(h,{className:"p-8 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(Te,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No hay estructura de Ã¡rbol disponible"}),e.jsx("p",{children:"Crea algunas categorÃ­as principales y subcategorÃ­as para ver la estructura"})]})})]})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(h,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total CategorÃ­as"})]})}),e.jsx(h,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:D.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"CategorÃ­as Principales"})]})}),e.jsx(h,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(s=>s.parentId).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"SubcategorÃ­as"})]})}),e.jsx(h,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Math.max(...m.map(s=>s.level||0))+1}),e.jsx("div",{className:"text-sm text-gray-600",children:"Niveles MÃ¡ximos"})]})})]}),e.jsx(es,{open:q||Le,onOpenChange:s=>{s||(W(!1),X(!1),re(null),g.reset())},children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsxs(as,{children:[e.jsx(ls,{children:q?"Nueva CategorÃ­a":"Editar CategorÃ­a"}),e.jsx(rs,{children:q?"Crea una nueva categorÃ­a para organizar tus activos":"Modifica los datos de la categorÃ­a seleccionada"})]}),e.jsx(ts,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(q?Be:Qe),className:"space-y-4",children:[e.jsx(_,{control:g.control,name:"name",render:({field:s})=>e.jsxs(G,{children:[e.jsx(J,{children:"Nombre *"}),e.jsx(H,{children:e.jsx(Ie,{placeholder:"Ej: Mobiliario Urbano",...s})}),e.jsx(U,{})]})}),e.jsx(_,{control:g.control,name:"description",render:({field:s})=>e.jsxs(G,{children:[e.jsx(J,{children:"DescripciÃ³n"}),e.jsx(H,{children:e.jsx(is,{placeholder:"Describe brevemente esta categorÃ­a...",className:"resize-none",rows:3,...s})}),e.jsx(U,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(_,{control:g.control,name:"icon",render:({field:s})=>e.jsxs(G,{children:[e.jsx(J,{children:"Ãcono *"}),e.jsxs(B,{onValueChange:s.onChange,value:s.value,children:[e.jsx(H,{children:e.jsx(Q,{children:e.jsx(O,{placeholder:"Seleccionar Ã­cono"})})}),e.jsx(R,{children:le.map(a=>e.jsx(f,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a.icon,{size:16}),a.label]})},a.value))})]}),e.jsx(U,{})]})}),e.jsx(_,{control:g.control,name:"color",render:({field:s})=>e.jsxs(G,{children:[e.jsx(J,{children:"Color *"}),e.jsxs(B,{onValueChange:s.onChange,value:s.value,children:[e.jsx(H,{children:e.jsx(Q,{children:e.jsx(O,{placeholder:"Seleccionar color"})})}),e.jsx(R,{children:vs.map(a=>e.jsx(f,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${a.bg}`}),a.label]})},a.value))})]}),e.jsx(U,{})]})})]}),q&&e.jsx(_,{control:g.control,name:"parentId",render:({field:s})=>e.jsxs(G,{children:[e.jsx(J,{children:"CategorÃ­a Padre (opcional)"}),e.jsxs(B,{onValueChange:a=>s.onChange(a==="null"?null:parseInt(a)),value:s.value?s.value.toString():(Y==null?void 0:Y.toString())||"null",children:[e.jsx(H,{children:e.jsx(Q,{children:e.jsx(O,{placeholder:"Seleccionar categorÃ­a padre"})})}),e.jsxs(R,{children:[e.jsx(f,{value:"null",children:"Sin categorÃ­a padre (Principal)"}),D.map(a=>e.jsx(f,{value:a.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[y(a.icon,16),a.name]})},a.id))]})]}),e.jsx(U,{})]})}),e.jsxs(ns,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{W(!1),X(!1)},children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:oe.isPending||xe.isPending,children:oe.isPending||xe.isPending?"Guardando...":"Guardar"})]})]})})]})})]})})};export{bs as default};
