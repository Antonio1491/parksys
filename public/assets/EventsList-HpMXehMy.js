import{a4 as c,l as oe,az as xe,u as N,ar as he,j as e,bh as _,f as j,i as x,dv as je,a6 as ge,V as ue,W as z,Y as A,_ as F,$ as P,a0 as r,B as i,a7 as pe,a8 as Ne,n as g,q,M as U,U as J,an as W,bC as $,bV as Y,y as ye,I as fe,J as ve,K as be,a as we,aC as Ce}from"./index-BKCBrrzQ.js";const Te=()=>{const[h,Z]=c.useState(""),[y,ee]=c.useState("all"),[f,se]=c.useState("all"),[u,ae]=c.useState("all"),[p,M]=c.useState("grid"),[a,te]=c.useState(null),[le,v]=c.useState(!1);c.useState(!1);const{toast:V}=oe(),ie=xe(),{data:d=[],isLoading:re}=N({queryKey:["/api/events"],retry:1}),{data:b=[]}=N({queryKey:["/api/event-categories"]}),{data:m=[]}=N({queryKey:["/api/parks"],retry:1}),{data:o=[]}=N({queryKey:["/api/event-categories"],retry:1}),ce=he({mutationFn:s=>Ce(`/api/events/${s}`,{method:"DELETE"}),onSuccess:()=>{ie.invalidateQueries({queryKey:["/api/events"]}),V({title:"Evento eliminado",description:"El evento ha sido eliminado exitosamente."})},onError:()=>{V({title:"Error",description:"No se pudo eliminar el evento.",variant:"destructive"})}}),B=s=>{te(s),v(!0)},w=s=>{window.location.href=`/admin/events/edit/${s.id}`},I=s=>{window.confirm("¿Estás seguro de que deseas eliminar este evento?")&&ce.mutate(s)},n=Array.isArray(d==null?void 0:d.data)?d.data:Array.isArray(d)?d:[],ne=Array.isArray(m==null?void 0:m.data)?m.data:Array.isArray(m)?m:[],de=Array.isArray(o==null?void 0:o.data)?o.data:Array.isArray(o)?o:[],C=s=>{const t=b==null?void 0:b.find(l=>l.name===s);return(t==null?void 0:t.color)||"#6b7280"},K=s=>{const t=C(s);return{backgroundColor:t+"20",color:t,borderColor:t+"40"}},E={upcoming:"Próximo",ongoing:"En curso",completed:"Completado",cancelled:"Cancelado",published:"Publicado",draft:"Borrador"},T={upcoming:"bg-blue-100 text-blue-800",ongoing:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800",published:"bg-emerald-100 text-emerald-800",draft:"bg-yellow-100 text-yellow-800"},X=n.filter(s=>{var Q,R,H,O;const t=((Q=s.title)==null?void 0:Q.toLowerCase().includes(h.toLowerCase()))||((R=s.description)==null?void 0:R.toLowerCase().includes(h.toLowerCase()))||((H=s.location)==null?void 0:H.toLowerCase().includes(h.toLowerCase()))||((O=s.organizer)==null?void 0:O.toLowerCase().includes(h.toLowerCase())),l=y==="all"||s.category===y,k=f==="all"||s.status===f,L=u==="all"||s.location===u||s.parkName===u;return t&&l&&k&&L}),me=s=>{if(!s)return"Fecha no disponible";try{return new Date(s).toLocaleDateString("es-MX",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}catch{return"Fecha inválida"}},G=(s,t)=>{if(!s)return"Fecha no disponible";try{const l=new Date(s);if(t){const[k,L]=t.split(":").map(Number);l.setHours(k,L,0,0)}return l.toLocaleDateString("es-MX",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Fecha inválida"}},S=s=>{if(s.startDate){const t=G(s.startDate,s.startTime);if(s.endDate&&s.endDate!==s.startDate){const l=G(s.endDate,s.endTime);return`${t} - ${l}`}else if(s.endTime&&s.endTime!==s.startTime){const l=s.endTime;return`${t} - ${l}`}return t}else if(s.date)return`${me(s.date)} ${s.time||""}`.trim();return"Fecha no disponible"},D=s=>s===0?"Gratuito":`$${s==null?void 0:s.toLocaleString()} MXN`;return re?e.jsx(_,{children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,t)=>e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"},t))})]})})}):e.jsxs(_,{children:[e.jsxs("div",{className:"p-6",children:[e.jsx(j,{className:"bg-gray-50 mb-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Listado de Eventos"})]})})}),e.jsx(j,{className:"mb-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(ue,{type:"text",placeholder:"Buscar eventos...",value:h,onChange:s=>Z(s.target.value),className:"pl-10"})]}),e.jsxs(z,{value:y,onValueChange:ee,children:[e.jsx(A,{className:"w-full sm:w-48",children:e.jsx(F,{placeholder:"Categoría"})}),e.jsxs(P,{children:[e.jsx(r,{value:"all",children:"Todas las categorías"}),de.map(s=>e.jsx(r,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(z,{value:f,onValueChange:se,children:[e.jsx(A,{className:"w-full sm:w-48",children:e.jsx(F,{placeholder:"Estado"})}),e.jsxs(P,{children:[e.jsx(r,{value:"all",children:"Todos los estados"}),e.jsx(r,{value:"upcoming",children:"Próximos"}),e.jsx(r,{value:"ongoing",children:"En curso"}),e.jsx(r,{value:"completed",children:"Completados"}),e.jsx(r,{value:"cancelled",children:"Cancelados"})]})]}),e.jsxs(z,{value:u,onValueChange:ae,children:[e.jsx(A,{className:"w-full sm:w-48",children:e.jsx(F,{placeholder:"Parque"})}),e.jsxs(P,{children:[e.jsx(r,{value:"all",children:"Todos los parques"}),ne.map(s=>e.jsx(r,{value:s.name,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:p==="grid"?"default":"outline",size:"sm",onClick:()=>M("grid"),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(i,{variant:p==="list"?"default":"outline",size:"sm",onClick:()=>M("list"),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:e.jsx(Ne,{className:"h-4 w-4"})})]})]})})}),X.length===0?e.jsx(j,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(g,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No se encontraron eventos"}),e.jsx("p",{className:"text-gray-600",children:n.length===0?"No hay eventos creados aún. Crea tu primer evento desde 'Nuevo Evento'.":"Intenta ajustar los filtros o buscar con otros términos."})]})}):e.jsx("div",{className:p==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:X.map(s=>e.jsx(j,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:p==="grid"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative h-48 bg-gray-100",children:[s.imageUrl||s.featuredImageUrl?e.jsx("img",{src:s.imageUrl||s.featuredImageUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sin imagen"})]})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(q,{className:`${T[s.status]}`,children:E[s.status]})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs("span",{className:"text-xs text-white bg-black/60 px-2 py-1 rounded",children:["#",s.id]})})]}),e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2 mb-2",children:s.title}),e.jsx("div",{className:"flex items-center gap-2",children:s.eventType&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",style:K(s.eventType),children:[e.jsx("div",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:C(s.eventType)}}),s.eventType]})})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:S(s)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:s.location||"Ubicación no especificada"})]}),s.capacity&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{children:[s.registeredCount||0," / ",s.capacity," participantes"]})]}),s.price!==void 0&&e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"font-medium text-green-600",children:D(s.price)})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>B(s),children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),"Ver"]}),e.jsxs(i,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>w(s),children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Editar"]}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>I(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})]}):e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),e.jsx(q,{className:T[s.status],children:E[s.status]}),s.eventType&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border",style:K(s.eventType),children:[e.jsx("div",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:C(s.eventType)}}),s.eventType]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-4 w-4 mr-1"}),S(s)]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),s.location||"Ubicación no especificada"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),s.registeredCount||0,"/",s.capacity||0]}),s.price!==void 0&&e.jsx("span",{className:"font-medium text-green-600",children:D(s.price)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>B(s),children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>w(s),children:e.jsx($,{className:"h-4 w-4"})}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>I(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})})},s.id))}),n.length>0&&e.jsx(j,{className:"mt-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total de eventos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.filter(s=>s.status==="upcoming").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Próximos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.filter(s=>s.status==="ongoing").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"En curso"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:n.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Completados"})]})]})})})]}),e.jsx(ye,{open:le,onOpenChange:v,children:e.jsxs(fe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ve,{children:e.jsx(be,{className:"text-2xl font-bold text-gray-900",children:"Detalles del Evento"})}),a&&e.jsxs("div",{className:"space-y-6",children:[a.imageUrl&&e.jsx("div",{className:"w-full h-64 overflow-hidden rounded-lg",children:e.jsx("img",{src:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Información General"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Título:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.title})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Estado:"}),e.jsx(q,{className:T[a.status],children:E[a.status]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Categoría:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.category||"No especificada"})]}),a.eventType&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Tipo de evento:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.eventType})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Organizador:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.organizerName||a.organizer||"No especificado"})]}),a.organizerEmail&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.organizerEmail})]}),a.organizerPhone&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Teléfono:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.organizerPhone})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Fecha y Ubicación"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:S(a)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.location||"Ubicación no especificada"})]}),a.parks&&a.parks.length>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-900",children:["Parques: ",a.parks.map(s=>s.name).join(", ")]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Capacidad y Participantes"}),e.jsxs("div",{className:"space-y-2",children:[a.capacity&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Capacidad total:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.capacity," personas"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Registrados:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.registeredCount||0," personas"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Disponibles:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.capacity-(a.registeredCount||0)," personas"]})]})]}),a.price!==void 0&&a.price!==null&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Precio:"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:D(a.price)})]}),(!a.capacity||a.capacity===0)&&e.jsx("div",{className:"text-sm text-gray-500 italic",children:"Sin límite de capacidad especificado"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Fechas del Sistema"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Creado:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(a.createdAt).toLocaleDateString("es-MX")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Actualizado:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(a.updatedAt).toLocaleDateString("es-MX")})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:a.description})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(i,{onClick:()=>w(a),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Editar Evento"]}),e.jsx(i,{variant:"outline",onClick:()=>v(!1),children:"Cerrar"})]})]})]})})]})};export{Te as default};
