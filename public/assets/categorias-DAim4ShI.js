import{ay as n,aH as T,l as E,az as F,a4 as D,u as q,ar as A,j as e,bh as z,bi as L,B as p,bv as P,f as I,g as M,h as K,bC as k,bT as y,bU as Q,bV as B,bW as H,bX as $,bY as R,bZ as V,b_ as G,b$ as J,c0 as U,i as W,q as X,aA as Y,aB as Z,aC as C,y as _,I as ee,J as se,K as ae,aI as ie,aJ as d,aK as x,aL as m,aM as h,V as u,aN as j,a1 as re}from"./index-BKCBrrzQ.js";const te=n.object({name:n.string().min(1,"El nombre es obligatorio").max(100,"Máximo 100 caracteres"),description:n.string().optional(),color:n.string().regex(/^#[0-9A-F]{6}$/i,"Color debe ser un código hexadecimal válido").default("#00a587"),icon:n.string().min(1,"El icono es obligatorio").default("calendar"),sortOrder:n.number().default(0),isActive:n.boolean().default(!0)}),ne=({category:s,onSuccess:v,isOpen:b,onOpenChange:l})=>{const{toast:o}=E(),t=F(),r=Y({resolver:Z(te),defaultValues:{name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",color:(s==null?void 0:s.color)||"#00a587",icon:(s==null?void 0:s.icon)||"calendar",sortOrder:(s==null?void 0:s.sortOrder)||0,isActive:(s==null?void 0:s.isActive)??!0}}),c=A({mutationFn:a=>C("/api/activity-categories",{method:"POST",data:a}),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/activity-categories"]}),o({title:"Categoría creada exitosamente"}),v()},onError:a=>{o({title:"Error al crear categoría",description:a.message,variant:"destructive"})}}),g=A({mutationFn:a=>C(`/api/activity-categories/${s==null?void 0:s.id}`,{method:"PUT",data:a}),onSuccess:()=>{t.invalidateQueries({queryKey:["/api/activity-categories"]}),o({title:"Categoría actualizada exitosamente"}),v()},onError:a=>{o({title:"Error al actualizar categoría",description:a.message,variant:"destructive"})}}),N=a=>{s?g.mutate(a):c.mutate(a)};return e.jsx(_,{open:b,onOpenChange:l,children:e.jsxs(ee,{className:"sm:max-w-[525px]",children:[e.jsx(se,{children:e.jsx(ae,{children:s?"Editar Categoría":"Nueva Categoría"})}),e.jsx(ie,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(N),className:"space-y-4",children:[e.jsx(d,{control:r.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(m,{children:"Nombre"}),e.jsx(h,{children:e.jsx(u,{placeholder:"Ej. Arte y Cultura",...a})}),e.jsx(j,{})]})}),e.jsx(d,{control:r.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(m,{children:"Descripción"}),e.jsx(h,{children:e.jsx(re,{placeholder:"Descripción de la categoría...",className:"resize-none",...a})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{control:r.control,name:"color",render:({field:a})=>e.jsxs(x,{children:[e.jsx(m,{children:"Color"}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{type:"color",className:"w-12 h-9 p-1 border rounded-md",...a}),e.jsx(u,{placeholder:"#00a587",className:"flex-1",...a})]})}),e.jsx(j,{})]})}),e.jsx(d,{control:r.control,name:"sortOrder",render:({field:a})=>e.jsxs(x,{children:[e.jsx(m,{children:"Orden"}),e.jsx(h,{children:e.jsx(u,{type:"number",placeholder:"0",...a,onChange:f=>a.onChange(Number(f.target.value))})}),e.jsx(j,{})]})})]}),e.jsx(d,{control:r.control,name:"icon",render:({field:a})=>e.jsxs(x,{children:[e.jsx(m,{children:"Icono (Lucide)"}),e.jsx(h,{children:e.jsx(u,{placeholder:"calendar",...a})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(p,{type:"submit",disabled:c.isPending||g.isPending,children:c.isPending||g.isPending?"Guardando...":s?"Actualizar":"Crear"})]})]})})]})})},oe=()=>{T();const{toast:s}=E(),v=F(),[b,l]=D.useState(),[o,t]=D.useState(!1),{data:r,isLoading:c,error:g}=q({queryKey:["/api/activity-categories"],queryFn:async()=>{const i=await C("/api/activity-categories");return i&&typeof i.json=="function"?await i.json():i}}),N=Array.isArray(r)?r:[],a=A({mutationFn:i=>C(`/api/activity-categories/${i}`,{method:"DELETE"}),onSuccess:()=>{v.invalidateQueries({queryKey:["/api/activity-categories"]}),s({title:"Categoría eliminada exitosamente"})},onError:i=>{s({title:"Error al eliminar categoría",description:i.message,variant:"destructive"})}}),f=i=>{l(i),t(!0)},w=()=>{l(void 0),t(!0)},S=()=>{t(!1),l(void 0)},O=i=>{a.mutate(i)};return e.jsx(z,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(L,{className:"w-8 h-8"}),"Dashboard"]}),e.jsx("p",{className:"text-gray-500",children:"Gestiona las categorías para organizar las actividades"})]}),e.jsxs(p,{onClick:w,className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Nueva Categoría"]})]}),c?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"Cargando categorías..."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(i=>e.jsxs(I,{className:"hover:shadow-md transition-shadow",children:[e.jsx(M,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(K,{className:"text-lg flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:i.color}}),i.name]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>f(i),children:e.jsx(k,{className:"h-4 w-4"})}),e.jsxs(y,{children:[e.jsx(Q,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(B,{className:"h-4 w-4"})})}),e.jsxs(H,{children:[e.jsxs($,{children:[e.jsx(R,{children:"¿Eliminar categoría?"}),e.jsxs(V,{children:['Esta acción no se puede deshacer. La categoría "',i.name,'" será eliminada permanentemente.']})]}),e.jsxs(G,{children:[e.jsx(J,{children:"Cancelar"}),e.jsx(U,{onClick:()=>O(i.id),className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})}),e.jsxs(W,{children:[i.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{variant:i.isActive?"default":"secondary",children:i.isActive?"Activa":"Inactiva"})}),e.jsxs("div",{children:["Orden: ",i.sortOrder]})]})]})]},i.id))}),e.jsx(ne,{category:b,onSuccess:S,isOpen:o,onOpenChange:t})]})})};export{oe as default};
