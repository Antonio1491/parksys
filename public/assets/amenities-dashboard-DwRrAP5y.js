import{a4 as b,u as j,j as s,b7 as n,aj as a,O as y,B as f,bG as v,bj as N,U as A,ao as C,bc as M,bd as k,be as q,bf as P,bg as w,bx as D,q as W}from"./index-BKCBrrzQ.js";import{M as r,V as L}from"./vertical-bar-chart-BIgnbi8N.js";import{G as l}from"./graphic-card-DqEiXv3p.js";function $(){const[d,c]=b.useState(0),{data:m,isLoading:x,error:u}=j({queryKey:["/api/amenities/dashboard",d]}),h=()=>{c(i=>i+1)};if(x)return s.jsx(n,{icon:a,title:"Amenidades",subtitle:"Análisis y estadísticas de amenidades en parques",backgroundColor:"#14b8a6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando estadísticas..."})]})})});if(u)return s.jsx(n,{icon:a,title:"Amenidades",subtitle:"Análisis y estadísticas de amenidades en parques",backgroundColor:"#14b8a6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx(y,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("p",{className:"text-red-600",children:"Error al cargar los datos del resumen operativo"}),s.jsxs(f,{onClick:h,className:"mt-4",children:[s.jsx(v,{className:"h-4 w-4 mr-2"}),"Reintentar"]})]})})});const e=m;return(()=>{if(!e)return[];const i=[];if(e.averageAmenitiesPerPark<2&&i.push("Los parques tienen pocas amenidades en promedio. Considere expandir la oferta."),e.mostPopularAmenities.length>0){const t=e.mostPopularAmenities[0];i.push(`"${t.name}" es la amenidad más popular con ${t.parksCount} parques.`)}return e.totalAmenities>e.totalParks*2&&i.push("Hay una buena variedad de amenidades disponibles en el sistema."),i})(),s.jsx(n,{icon:a,title:"Amenidades",subtitle:"Análisis y estadísticas de amenidades en parques",backgroundColor:"#14b8a6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsx(r,{title:"Total Amenidades",value:s.jsx("div",{className:"text-2xl font-bold text-white mb-2",children:(e==null?void 0:e.totalAmenities)||0}),subtitle:"Amenidades registradas",icon:a,iconColor:"#14b8a6",backgroundColor:"#003D49"}),s.jsx(r,{title:"Promedio por Parque",value:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-2xl font-bold text-white",children:(e==null?void 0:e.averageAmenitiesPerPark.toFixed(1))||"0"}),(e==null?void 0:e.parkWithMostAmenities)&&s.jsxs("div",{className:"text-xs text-gray-300",children:["Máximo: ",e.parkWithMostAmenities.name," (",e.parkWithMostAmenities.count,")"]})]}),subtitle:"Amenidades por parque",icon:N,iconColor:"#14b8a6",backgroundColor:"#003D49"}),s.jsx(r,{title:"Total Módulos",value:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-2xl font-bold text-white",children:(e==null?void 0:e.totalModules)||0}),(e==null?void 0:e.amenityWithMostModules)&&s.jsxs("div",{className:"text-xs text-gray-300",children:["Líder: ",e.amenityWithMostModules.name," (",e.amenityWithMostModules.count,")"]})]}),subtitle:"Módulos registrados",icon:A,iconColor:"#14b8a6",backgroundColor:"#003D49"}),s.jsx(r,{title:"Categorías",value:s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"text-2xl font-bold text-white",children:(e==null?void 0:e.totalCategories)||0}),(e==null?void 0:e.categoryWithMostAmenities)&&s.jsxs("div",{className:"text-xs text-gray-300",children:["Líder: ",e.categoryWithMostAmenities.name," (",e.categoryWithMostAmenities.count,")"]})]}),subtitle:"Categorías registradas",icon:C,iconColor:"#14b8a6",backgroundColor:"#003D49"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsx("h2",{className:"text-xl font-semibold",children:"Categorías de Amenidades"})}),s.jsx("div",{className:"h-80",children:!(e!=null&&e.amenityDistribution)||e.amenityDistribution.length===0?s.jsx("div",{className:"text-center py-4 text-gray-500",children:"No hay categorías disponibles"}):s.jsx(M,{width:"100%",height:"100%",children:s.jsxs(k,{children:[s.jsx(q,{data:(e==null?void 0:e.amenityDistribution)||[],cx:"50%",cy:"50%",outerRadius:80,innerRadius:30,paddingAngle:2,dataKey:"value",label:({value:i,percent:t})=>`${i} (${(t*100).toFixed(0)}%)`,labelLine:!1,children:((e==null?void 0:e.amenityDistribution)||[]).map((i,t)=>s.jsx(P,{fill:i.color},`cell-${t}`))}),s.jsx(w,{formatter:i=>[`${i} amenidades`,"Cantidad"],labelStyle:{color:"#374151",fontWeight:"bold"}}),s.jsx(D,{wrapperStyle:{paddingTop:"20px",fontSize:"12px"},formatter:(i,t)=>{const o=((e==null?void 0:e.amenityDistribution)||[]).find(g=>g.name===i),p=o?o.value:0;return s.jsxs("span",{style:{color:"#374151",fontSize:"12px",fontWeight:"500"},children:[i.charAt(0).toUpperCase()+i.slice(1)," (",p," amenidades)"]})}})]})})})]}),s.jsx(l,{title:"Amenidades por Parque",className:"h-full",children:s.jsx(L,{data:((e==null?void 0:e.utilizationByPark)||[]).map(i=>({label:i.parkName,value:i.amenitiesCount,id:i.parkName})),emptyStateTitle:"No hay datos de amenidades disponibles",emptyStateDescription:"Los datos de amenidades por parque aparecerán aquí una vez que se asignen amenidades a los parques",footerText:((e==null?void 0:e.utilizationByPark)||[]).length>0?`Mostrando todos los ${((e==null?void 0:e.utilizationByPark)||[]).length} parques registrados en el sistema`:void 0,sortDescending:!0,showLabels:!0})})]}),s.jsx("div",{className:"grid grid-cols-1 gap-6",children:s.jsx(l,{title:"Top 5 Amenidades con Más Módulos",description:"Amenidades ordenadas por cantidad total de módulos",children:s.jsx("div",{className:"space-y-3",children:((e==null?void 0:e.mostPopularAmenities)||[]).sort((i,t)=>t.totalModules-i.totalModules).slice(0,5).map((i,t)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(W,{variant:"secondary",children:t+1}),s.jsx("span",{className:"font-medium",children:i.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"font-bold",children:i.totalModules}),s.jsx("div",{className:"text-xs text-gray-500",children:i.totalModules===1?"módulo":"módulos"}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.parksCount," ",i.parksCount===1?"parque":"parques"]})]})]},i.id))})})})]})})}export{$ as default};
